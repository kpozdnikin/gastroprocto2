{"version":3,"sources":["filters.js"],"names":[],"mappings":"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","file":"filters-compiled.js","sourcesContent":["/*!\n * Webogram v0.5.5 - messaging web application for MTProto\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\n'use strict'\n\n/* Filters */\n\nangular.module('myApp.filters', ['myApp.i18n'])\n\n  .filter('userName', function (_) {\n    return function (user) {\n      if (!user || !user.first_name && !user.last_name) {\n        return _('user_name_deleted')\n      }\n      return user.first_name + (user.last_name ? ' ' + user.last_name : '')\n    }\n  })\n\n  .filter('userFirstName', function (_) {\n    return function (user) {\n      if (!user || !user.first_name && !user.last_name) {\n        return _('user_first_name_deleted')\n      }\n      return user.first_name || user.last_name\n    }\n  })\n\n  .filter('userStatus', function ($filter, _) {\n    var relativeTimeFilter = $filter('relativeTime')\n    return function (user, botChatPrivacy) {\n      if (!(user.id % 1000)) {\n        if (user.id == 777000) {\n          return _('user_status_service_notifications')\n        }\n        return _('user_status_support')\n      }\n      var statusType = user && user.status && user.status._\n      if (!statusType) {\n        statusType = user && user.pFlags && user.pFlags.bot ? 'userStatusBot' : 'userStatusEmpty'\n      }\n      switch (statusType) {\n        case 'userStatusOnline':\n          return _('user_status_online')\n\n        case 'userStatusOffline':\n          return _('user_status_last_seen', relativeTimeFilter(user.status.was_online))\n\n        case 'userStatusRecently':\n          return _('user_status_recently')\n\n        case 'userStatusLastWeek':\n          return _('user_status_last_week')\n\n        case 'userStatusLastMonth':\n          return _('user_status_last_month')\n\n        case 'userStatusBot':\n          if (botChatPrivacy) {\n            if (user.pFlags.bot_chat_history) {\n              return _('user_status_bot_noprivacy')\n            } else {\n              return _('user_status_bot_privacy')\n            }\n          }\n          return _('user_status_bot')\n\n        case 'userStatusEmpty':\n        default:\n          return _('user_status_long_ago')\n      }\n    }\n  })\n\n  .filter('chatTitle', function (_) {\n    return function (chat) {\n      if (!chat || !chat.title) {\n        return _('chat_title_deleted')\n      }\n      return chat.title\n    }\n  })\n\n  .filter('dateOrTime', function ($filter) {\n    var dateFilter = $filter('date')\n\n    return function (timestamp, extended) {\n      if (!timestamp) {\n        return ''\n      }\n      var ticks = timestamp * 1000\n      var diff = Math.abs(tsNow() - ticks)\n      var format = 'shortTime'\n\n      if (diff > 518400000) { // 6 days\n        format = extended ? 'mediumDate' : 'shortDate'\n      }\n      else if (diff > 43200000) { // 12 hours\n        format = extended ? 'EEEE' : 'EEE'\n      }\n\n      return dateFilter(ticks, format)\n    }\n  })\n\n  .filter('time', function ($filter) {\n    var cachedDates = {}\n    var dateFilter = $filter('date')\n    var format = Config.Mobile ? 'shortTime' : 'mediumTime'\n\n    return function (timestamp) {\n      if (cachedDates[timestamp]) {\n        return cachedDates[timestamp]\n      }\n\n      return cachedDates[timestamp] = dateFilter(timestamp * 1000, format)\n    }\n  })\n\n  .filter('myDate', function ($filter) {\n    var cachedDates = {}\n    var dateFilter = $filter('date')\n\n    return function (timestamp) {\n      if (cachedDates[timestamp]) {\n        return cachedDates[timestamp]\n      }\n\n      return cachedDates[timestamp] = dateFilter(timestamp * 1000, 'fullDate')\n    }\n  })\n\n  .filter('duration', [function () {\n    return function (duration) {\n      duration = parseInt(duration)\n      if (isNaN(duration)) {\n        duration = 0\n      }\n      var hours = Math.floor(duration / 3600)\n      var mins = Math.floor((duration % 3600) / 60)\n      var secs = duration % 60\n\n      var durationStr = (hours ? hours + ':' : '') + mins + ':' + secs\n\n      durationStr = durationStr.replace(/:(\\d(?::|$))/g, ':0$1')\n\n      return durationStr\n    }\n  }])\n\n  .filter('durationRemains', function ($filter) {\n    var durationFilter = $filter('duration')\n\n    return function (done, total) {\n      return '-' + durationFilter(total - done)\n    }\n  })\n\n  .filter('phoneNumber', [function () {\n    return function (phoneRaw) {\n      var nbsp = ' '\n      phoneRaw = (phoneRaw || '').replace(/\\D/g, '')\n      if (phoneRaw.charAt(0) == '7' && phoneRaw.length == 11) {\n        return '+' + phoneRaw.charAt(0) + nbsp + '(' + phoneRaw.substr(1, 3) + ')' + nbsp + phoneRaw.substr(4, 3) + '-' + phoneRaw.substr(7, 2) + '-' + phoneRaw.substr(9, 2)\n      }\n      return '+' + phoneRaw\n    }\n  }])\n\n  .filter('formatSize', [function () {\n    return function (size, progressing) {\n      if (!size) {\n        return '0'\n      }\n      else if (size < 1024) {\n        return size + ' b'\n      }\n      else if (size < 1048576) {\n        return Math.round(size / 1024) + ' KB'\n      }\n      var mbs = size / 1048576\n      if (progressing) {\n        mbs = mbs.toFixed(1)\n      } else {\n        mbs = (Math.round(mbs * 10) / 10)\n      }\n      return mbs + ' MB'\n    }\n  }])\n\n  .filter('formatSizeProgress', function ($filter, _) {\n    var formatSizeFilter = $filter('formatSize')\n    return function (progress) {\n      if (!progress.total) {\n        return ''\n      }\n      var done = formatSizeFilter(progress.done, true)\n      var doneParts = done.split(' ')\n      var total = formatSizeFilter(progress.total)\n      var totalParts = total.split(' ')\n\n      if (totalParts[1] === doneParts[1]) {\n        return _('format_size_progress_mulitple', {done: doneParts[0], total: totalParts[0], parts: (doneParts[1] || '')})\n      }\n      return _('format_size_progress', {done: done, total: total})\n    }\n  })\n\n  .filter('formatShortNumber', [function () {\n    return function (num) {\n      if (!num) {\n        return '0'\n      }\n      else if (num < 1000) {\n        return num.toString()\n      }\n      else if (num < 900000) {\n        var mult = num > 10000 ? 1 : 10\n        return (Math.round(num / 1000 * mult) / mult) + 'K'\n      }\n      var mult = num > 10000000 ? 1 : 10\n      return (Math.round(num / 1000000 * mult) / mult) + 'M'\n    }\n  }])\n\n  .filter('nl2br', [function () {\n    return function (text) {\n      return text.replace(/\\n/g, '<br/>')\n    }\n  }])\n\n  .filter('shortUrl', [function () {\n    return function (text) {\n      if (typeof text !== 'string') {\n        return text\n      }\n      return text.replace(/^https?:\\/\\//, '').replace(/^www\\./, '')\n    }\n  }])\n\n  .filter('richText', function ($filter) {\n    var linkyFilter = $filter('linky')\n    return function (text) {\n      return linkyFilter(text, '_blank').replace(/\\n|&#10;/g, '<br/>')\n    }\n  })\n\n  .filter('relativeTime', function ($filter, _) {\n    var langMinutesPluralize = _.pluralize('relative_time_pluralize_minutes_ago')\n    var langHoursPluralize = _.pluralize('relative_time_pluralize_hours_ago')\n    var dateOrTimeFilter = $filter('dateOrTime')\n\n    return function (timestamp) {\n      var diff = Math.abs(tsNow(true) - timestamp)\n\n      if (diff < 60) {\n        return _('relative_time_just_now')\n      }\n      if (diff < 3600) {\n        var minutes = Math.floor(diff / 60)\n        return langMinutesPluralize(minutes)\n      }\n      if (diff < 86400) {\n        var hours = Math.floor(diff / 3600)\n        return langHoursPluralize(hours)\n      }\n      return dateOrTimeFilter(timestamp, true)\n    }\n  })\n"]}