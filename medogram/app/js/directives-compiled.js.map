{"version":3,"sources":["directives.js"],"names":[],"mappings":"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","file":"directives-compiled.js","sourcesContent":["/*!\n * Webogram v0.5.5 - messaging web application for MTProto\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\n'use strict'\n\n/* Directives */\n\nangular.module('myApp.directives', ['myApp.filters'])\n\n  .constant('shouldFocusOnInteraction', !Config.Navigator.mobile)\n\n  .directive('myHead', function () {\n    return {\n      restrict: 'AE',\n      templateUrl: templateUrl('head')\n    }\n  })\n\n  .directive('myLangFooter', function () {\n    return {\n      restrict: 'AE',\n      templateUrl: templateUrl('lang_footer')\n    }\n  })\n\n  .directive('myFooter', function () {\n    return {\n      restrict: 'AE',\n      templateUrl: templateUrl('footer')\n    }\n  })\n\n  .directive('myDialog', function () {\n    return {\n      restrict: 'AE',\n      templateUrl: templateUrl('dialog')\n    }\n  })\n\n  .directive('myMessage', function ($filter, _) {\n    var dateFilter = $filter('myDate')\n    var dateSplitHtml = '<div class=\"im_message_date_split im_service_message_wrap\"><div class=\"im_service_message\"><span class=\"copyonly\"><br/>---&nbsp;</span><span class=\"im_message_date_split_text\"></span><span class=\"copyonly\">&nbsp;---</span></div></div>',\n      unreadSplitHtml = '<div class=\"im_message_unread_split\">' + _('unread_messages_split') + '</div>',\n      selectedClass = 'im_message_selected',\n      focusClass = 'im_message_focus',\n      unreadClass = 'im_message_unread',\n      errorClass = 'im_message_error',\n      pendingClass = 'im_message_pending'\n\n    return {\n      templateUrl: templateUrl('message'),\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var selected = false\n      var grouped = false\n      var focused = false\n      var error = false\n      var pending = false\n      var needDate = false\n      var unreadAfter = false\n      var applySelected = function () {\n          if (selected != ($scope.selectedMsgs[$scope.historyMessage.mid] || false)) {\n            selected = !selected\n            element.toggleClass(selectedClass, selected)\n          }\n        },\n        needDateSplit,\n        applyGrouped = function () {\n          if (grouped != $scope.historyMessage.grouped) {\n            if (grouped) {\n              element.removeClass(grouped)\n            }\n            grouped = $scope.historyMessage.grouped\n            if (grouped) {\n              element.addClass(grouped)\n            }\n          }\n          if (needDate != ($scope.historyMessage.needDate || false)) {\n            needDate = !needDate\n            if (needDate) {\n              if (needDateSplit) {\n                needDateSplit.show()\n              } else {\n                needDateSplit = $(dateSplitHtml)\n                $('.im_message_date_split_text', needDateSplit).text(dateFilter($scope.historyMessage.date))\n                if (unreadAfterSplit) {\n                  needDateSplit.insertBefore(unreadAfterSplit)\n                } else {\n                  needDateSplit.prependTo(element)\n                }\n              }\n            } else {\n              needDateSplit.hide()\n            }\n          }\n        },\n        unreadAfterSplit\n\n      applySelected()\n      applyGrouped()\n\n      $scope.$on('messages_select', applySelected)\n      $scope.$on('messages_regroup', applyGrouped)\n\n      $scope.$on('messages_focus', function (e, focusedMsgID) {\n        if ((focusedMsgID == $scope.historyMessage.mid) != focused) {\n          focused = !focused\n          element.toggleClass(focusClass, focused)\n        }\n      })\n\n      var deregisterUnreadAfter\n      if (!$scope.historyMessage.pFlags.out &&\n        ($scope.historyMessage.pFlags.unread || $scope.historyMessage.unreadAfter)) {\n        var applyUnreadAfter = function () {\n          if ($scope.peerHistory.peerID != $scope.historyPeer.id) {\n            return\n          }\n          if (unreadAfter != ($scope.historyUnreadAfter == $scope.historyMessage.mid)) {\n            unreadAfter = !unreadAfter\n            if (unreadAfter) {\n              if (unreadAfterSplit) {\n                unreadAfterSplit.show()\n              } else {\n                unreadAfterSplit = $(unreadSplitHtml).prependTo(element)\n              }\n            } else {\n              unreadAfterSplit.hide()\n              if (deregisterUnreadAfter) {\n                deregisterUnreadAfter()\n              }\n            }\n          }\n        }\n        applyUnreadAfter()\n        deregisterUnreadAfter = $scope.$on('messages_unread_after', applyUnreadAfter)\n      }\n      if ($scope.historyMessage.pFlags.unread && $scope.historyMessage.pFlags.out) {\n        element.addClass(unreadClass)\n        var deregisterUnread = $scope.$on('messages_read', function () {\n          if (!$scope.historyMessage.pFlags.unread) {\n            element.removeClass(unreadClass)\n            deregisterUnread()\n            if (deregisterUnreadAfter && !unreadAfter) {\n              deregisterUnreadAfter()\n            }\n          }\n        })\n      }\n      if ($scope.historyMessage.error || $scope.historyMessage.pending) {\n        var applyPending = function () {\n            if (pending != ($scope.historyMessage.pending || false)) {\n              pending = !pending\n              element.toggleClass(pendingClass, pending)\n            }\n            if (error != ($scope.historyMessage.error || false)) {\n              error = !error\n              element.toggleClass(errorClass, error)\n            }\n            if (!error && !pending) {\n              deregisterPending()\n            }\n          },\n          deregisterPending = $scope.$on('messages_pending', applyPending)\n\n        applyPending()\n      }\n    }\n  })\n\n  .directive('myMessageBody', function ($compile, AppPeersManager, AppChatsManager, AppUsersManager, AppMessagesManager, AppInlineBotsManager, RichTextProcessor) {\n    var messageMediaCompiled = $compile('<div class=\"im_message_media\" my-message-media=\"media\" message-id=\"messageId\"></div>')\n    var messageKeyboardCompiled = $compile('<div class=\"im_message_keyboard\" my-inline-reply-markup=\"markup\"></div>')\n    var messageSignCompiled = $compile('<div class=\"im_message_sign\"><span class=\"im_message_sign_link\" my-peer-link=\"signID\"></span></div>')\n\n    return {\n      link: link,\n      scope: {\n        message: '=myMessageBody'\n      }\n    }\n\n    function updateMessageText ($scope, element, message) {\n      if (message.media && message.media.handleMessage ||\n          typeof message.message !== 'string' ||\n        !message.message.length) {\n        $('.im_message_text', element).hide()\n        return\n      }\n      var html = AppMessagesManager.wrapMessageText(message.mid)\n      $('.im_message_text', element).html(html.valueOf())\n    }\n\n    function updateMessageMedia ($scope, element, message) {\n      if (!message.media) {\n        $('.im_message_media', element).hide()\n        return\n      }\n\n      var scope = $scope.$new(true)\n      scope.media = message.media\n      scope.messageId = message.mid\n      messageMediaCompiled(scope, function (clonedElement) {\n        $('.im_message_media', element).replaceWith(clonedElement)\n      })\n    }\n\n    function updateMessageSignature ($scope, element, message) {\n      if (!message.signID) {\n        $('.im_message_sign', element).hide()\n        return\n      }\n\n      var scope = $scope.$new(true)\n      scope.signID = message.signID\n      messageSignCompiled(scope, function (clonedElement) {\n        $('.im_message_sign', element).replaceWith(clonedElement)\n      })\n    }\n\n    function updateMessageKeyboard ($scope, element, message) {\n      if (!message.reply_markup ||\n        message.reply_markup._ != 'replyInlineMarkup') {\n        $('.im_message_keyboard', element).hide()\n        return\n      }\n\n      var scope = $scope.$new(true)\n      scope.markup = AppMessagesManager.wrapReplyMarkup(message.reply_markup)\n      scope.messageId = message.mid\n      messageKeyboardCompiled(scope, function (clonedElement) {\n        $('.im_message_keyboard', element).replaceWith(clonedElement)\n      })\n\n      scope.$on('reply_inline_button_press', function (e, button) {\n        switch (button._) {\n          case 'keyboardButtonSwitchInline':\n            AppInlineBotsManager.switchInlineButtonClick(message.mid, button)\n            break\n          case 'keyboardButtonCallback':\n            AppInlineBotsManager.callbackButtonClick(message.mid, button)\n            break\n          case 'keyboardButtonGame':\n            AppInlineBotsManager.gameButtonClick(message.mid)\n            break\n        }\n      })\n    }\n\n    function updateMessageBody ($scope, element, message) {\n      updateMessageText($scope, element, message)\n      updateMessageMedia($scope, element, message)\n      updateMessageSignature($scope, element, message)\n      updateMessageKeyboard($scope, element, message)\n    }\n\n    function link ($scope, element, attrs) {\n      var message = $scope.message\n      message.dir = true\n      var msgID = message.mid\n\n      updateMessageBody($scope, element, message)\n\n      if (message.pending) {\n        var unlink = $scope.$on('messages_pending', function () {\n          if (message.mid != msgID) {\n            updateMessageBody($scope, element, message)\n            unlink()\n          }\n        })\n      }\n\n      $scope.$on('message_edit', function (e, data) {\n        if (data.mid == message.mid) {\n          if (data.justMedia) {\n            updateMessageMedia($scope, element, message)\n          } else {\n            updateMessageBody($scope, element, message)\n          }\n        }\n      })\n    }\n  })\n\n  .directive('myMessageViews', function ($filter, AppMessagesManager) {\n    var formatNumberFilter = $filter('formatShortNumber')\n\n    return {\n      link: link\n    }\n\n    function updateHtml (views, element) {\n      element.html(formatNumberFilter(views))\n    }\n\n    function link ($scope, element, attrs) {\n      var mid = $scope.$eval(attrs.myMessageViews)\n      // console.log(element[0], mid)\n      var views = AppMessagesManager.getMessage(mid).views || 0\n\n      updateHtml(views, element)\n\n      $scope.$on('message_views', function (e, viewData) {\n        if (viewData.mid == mid) {\n          updateHtml(viewData.views, element)\n        }\n      })\n    }\n  })\n\n  .directive('myReplyMarkup', function () {\n    return {\n      templateUrl: templateUrl('reply_markup'),\n      scope: {\n        'replyMarkup': '=myReplyMarkup'\n      },\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var scrollable = $('.reply_markup', element)\n      var scroller = new Scroller(scrollable, {\n        classPrefix: 'reply_markup',\n        maxHeight: 170\n      })\n      $scope.buttonClick = function (button) {\n        $scope.$emit('reply_button_press', button)\n      }\n\n      $scope.$on('ui_keyboard_update', function (e, data) {\n        onContentLoaded(function () {\n          scroller.updateHeight()\n          scroller.scrollTo(0)\n          $scope.$emit('ui_panel_update', {blur: data && data.enabled})\n        })\n      })\n      onContentLoaded(function () {\n        scroller.updateHeight()\n        $scope.$emit('ui_panel_update')\n      })\n    }\n  })\n\n  .directive('myMessageMedia', function () {\n    return {\n      scope: {\n        'media': '=myMessageMedia',\n        'messageId': '=messageId'\n      },\n      templateUrl: templateUrl('message_media')\n    }\n  })\n  .directive('myMessagePhoto', function (AppPhotosManager) {\n    return {\n      scope: {\n        'media': '=myMessagePhoto',\n        'messageId': '=messageId'\n      },\n      templateUrl: templateUrl('message_attach_photo'),\n      link: function ($scope, element, attrs) {\n        $scope.openPhoto = AppPhotosManager.openPhoto\n        $scope.preloadPhoto = AppPhotosManager.preloadPhoto\n      }\n    }\n  })\n  .directive('myMessageDocument', function (AppDocsManager) {\n    return {\n      scope: {\n        'media': '=myMessageDocument',\n        'messageId': '=messageId'\n      },\n      templateUrl: templateUrl('message_attach_document'),\n      link: function ($scope, element, attrs) {\n        AppDocsManager.updateDocDownloaded($scope.media.document.id)\n        $scope.docSave = function () {\n          AppDocsManager.saveDocFile($scope.media.document.id)\n        }\n        $scope.docOpen = function () {\n          if (!$scope.media.document.withPreview) {\n            return $scope.docSave()\n          }\n          AppDocsManager.openDoc($scope.media.document.id, $scope.messageId)\n        }\n        $scope.videoOpen = function () {\n          AppDocsManager.openVideo($scope.media.document.id, $scope.messageId)\n        }\n      }\n    }\n  })\n  .directive('myMessageGeo', function () {\n    return {\n      scope: {\n        'media': '=myMessageGeo'\n      },\n      templateUrl: templateUrl('message_attach_geo')\n    }\n  })\n  .directive('myMessageVenue', function () {\n    return {\n      scope: {\n        'media': '=myMessageVenue'\n      },\n      templateUrl: templateUrl('message_attach_venue')\n    }\n  })\n  .directive('myMessageContact', function () {\n    return {\n      scope: {\n        'media': '=myMessageContact'\n      },\n      templateUrl: templateUrl('message_attach_contact')\n    }\n  })\n  .directive('myMessageWebpage', function (AppWebPagesManager, AppPhotosManager) {\n    return {\n      scope: {\n        'media': '=myMessageWebpage',\n        'messageId': '=messageId'\n      },\n      templateUrl: templateUrl('message_attach_webpage'),\n      link: function ($scope) {\n        $scope.openPhoto = AppPhotosManager.openPhoto\n        $scope.openEmbed = function ($event) {\n          if ($scope.media.webpage &&\n            $scope.media.webpage.embed_url) {\n            AppWebPagesManager.openEmbed($scope.media.webpage.id, $scope.messageId)\n            return cancelEvent($event)\n          }\n        }\n\n        $scope.$on('webpage_updated', function (e, eventData) {\n          if ($scope.media.webpage &&\n            $scope.media.webpage.id == eventData.id) {\n            $scope.$emit('ui_height')\n          }\n        })\n      }\n    }\n  })\n  .directive('myMessageGame', function (AppInlineBotsManager, AppMessagesManager) {\n    return {\n      scope: {\n        'media': '=myMessageGame',\n        'messageId': '=messageId'\n      },\n      templateUrl: templateUrl('message_attach_game'),\n      link: function ($scope, element) {\n        $scope.openGame = function () {\n          AppInlineBotsManager.gameButtonClick($scope.messageId)\n        }\n\n        function updateMessageText(argument) {\n          var message = AppMessagesManager.getMessage($scope.messageId)\n          if (message.message) {\n            var html = AppMessagesManager.wrapMessageText($scope.messageId)\n            $('.im_message_game_message', element).html(html.valueOf()).show()\n            $('.im_message_game_description', element).hide()\n          } else {\n            $('.im_message_game_message', element).html('').hide()\n            $('.im_message_game_description', element).show()\n          }\n        }\n\n        $scope.$on('message_edit', function (e, data) {\n          if (data.mid == $scope.messageId) {\n            updateMessageText()\n          }\n        })\n\n        updateMessageText()\n      }\n    }\n  })\n  .directive('myMessagePending', function () {\n    return {\n      scope: {\n        'media': '=myMessagePending'\n      },\n      templateUrl: templateUrl('message_attach_pending')\n    }\n  })\n\n  .directive('myInlineReplyMarkup', function () {\n    return {\n      templateUrl: templateUrl('reply_markup'),\n      scope: {\n        'replyMarkup': '=myInlineReplyMarkup'\n      },\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      $scope.buttonClick = function (button) {\n        $scope.$emit('reply_inline_button_press', button)\n      }\n    }\n  })\n\n  .directive('myServiceMessage', function () {\n    return {\n      templateUrl: templateUrl('message_service')\n    }\n  })\n\n  .directive('myShortMessage', function () {\n    return {\n      scope: {\n        message: '=myShortMessage'\n      },\n      templateUrl: templateUrl('short_message')\n    }\n  })\n\n  .directive('myReplyMessage', function (AppMessagesManager, AppPeersManager, $rootScope) {\n    return {\n      templateUrl: templateUrl('reply_message'),\n      scope: {},\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      if (attrs.watch) {\n        $scope.$parent.$watch(attrs.myReplyMessage, function (mid) {\n          checkMessage($scope, element, mid)\n        })\n      } else {\n        var mid = $scope.$parent.$eval(attrs.myReplyMessage)\n        checkMessage($scope, element, mid)\n      }\n    }\n\n    function checkMessage ($scope, element, mid) {\n      var message = $scope.replyMessage = AppMessagesManager.wrapSingleMessage(mid)\n      if (message.loading) {\n        var stopWaiting = $scope.$on('messages_downloaded', function (e, mids) {\n          if (mids.indexOf(mid) != -1) {\n            $scope.replyMessage = AppMessagesManager.wrapForDialog(mid)\n            updateMessage($scope, element)\n            stopWaiting()\n          }\n        })\n      } else {\n        updateMessage($scope, element)\n      }\n    }\n\n    function updateMessage ($scope, element) {\n      var message = $scope.replyMessage\n      if (!message || message.deleted || !message.to_id) {\n        $(element).remove()\n        return\n      }\n      $scope.thumb = AppMessagesManager.getMessageThumb(message, 42, 42)\n\n      if (element[0].tagName == 'A') {\n        element.on('click', function () {\n          var peerID = AppMessagesManager.getMessagePeer(message)\n          var peerString = AppPeersManager.getPeerString(peerID)\n\n          $rootScope.$broadcast('history_focus', {peerString: peerString, messageID: message.mid})\n        })\n      }\n\n      onContentLoaded(function () {\n        $scope.$emit('ui_height')\n      })\n    }\n  })\n\n  .directive('myPinnedMessage', function (AppMessagesManager, AppPeersManager, $rootScope) {\n    return {\n      templateUrl: templateUrl('pinned_message'),\n      scope: {},\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var mid = $scope.$parent.$eval(attrs.myPinnedMessage)\n      var message = $scope.pinnedMessage = AppMessagesManager.wrapSingleMessage(mid)\n      if (message.loading) {\n        var stopWaiting = $scope.$on('messages_downloaded', function (e, mids) {\n          if (mids.indexOf(mid) != -1) {\n            $scope.pinnedMessage = AppMessagesManager.wrapForDialog(mid)\n            updateMessage($scope, element)\n            stopWaiting()\n          }\n        })\n      } else {\n        updateMessage($scope, element)\n      }\n    }\n\n    function updateMessage ($scope, element) {\n      var message = $scope.pinnedMessage\n      if (!message || message.deleted || !message.to_id) {\n        $(element).remove()\n        return\n      }\n\n      if (element[0].tagName == 'A') {\n        element.on('click', function () {\n          var peerID = AppMessagesManager.getMessagePeer(message)\n          var peerString = AppPeersManager.getPeerString(peerID)\n\n          $rootScope.$broadcast('history_focus', {peerString: peerString, messageID: message.mid})\n        })\n      }\n\n      onContentLoaded(function () {\n        $scope.$emit('ui_height')\n      })\n    }\n  })\n\n  .directive('myForwardedMessages', function (AppPhotosManager, AppMessagesManager, AppPeersManager, $rootScope) {\n    return {\n      templateUrl: templateUrl('forwarded_messages'),\n      scope: {\n        'forwardMessages': '=myForwardedMessages'\n      },\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      if (attrs.watch) {\n        $scope.$watch('forwardMessages', function () {\n          updateMessages($scope, element)\n        })\n      } else {\n        updateMessages($scope, element)\n      }\n    }\n\n    function updateMessages ($scope, element) {\n      var mids = $scope.forwardMessages\n      var length = mids.length\n      var fromID = false\n      var single = length == 1\n      $scope.thumb = false\n      $scope.singleMessage = false\n      angular.forEach(mids, function (mid) {\n        var message = AppMessagesManager.getMessage(mid)\n        if (fromID === false) {\n          fromID = message.fromID\n        } else {\n          if (fromID !== message.fromID) {\n            fromID = AppMessagesManager.getMessagePeer(message)\n          }\n        }\n        if (single) {\n          $scope.thumb = AppMessagesManager.getMessageThumb(message, 42, 42)\n          $scope.singleMessage = AppMessagesManager.wrapForDialog(mid)\n        }\n      })\n      $scope.fromID = fromID\n      $scope.count = length\n\n      onContentLoaded(function () {\n        $scope.$emit('ui_height')\n      })\n    }\n  })\n\n  .directive('myDialogs', function ($modalStack, $transition, $window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var dialogsWrap = $('.im_dialogs_wrap', element)[0]\n      var scrollableWrap = $('.im_dialogs_scrollable_wrap', element)[0]\n      var searchField = $('.im_dialogs_search_field', element)[0]\n      var panelWrap = $('.im_dialogs_panel', element)[0]\n      var searchClear = $('.im_dialogs_search_clear', element)[0]\n      var searchFocused = false\n\n      $(searchField).on('focus blur', function (e) {\n        searchFocused = e.type == 'focus'\n\n        if (!searchFocused) {\n          $(scrollableWrap).find('.im_dialog_selected').removeClass('im_dialog_selected')\n          if (!searchField.value) {\n            $scope.$emit('ui_dialogs_search_clear')\n          }\n        }\n      })\n\n      $scope.$on('dialogs_search_toggle', function () {\n        $(panelWrap).addClass('im_dialogs_panel_search')\n        $scope.$broadcast('ui_dialogs_search')\n        $($window).scrollTop(0)\n        $timeout(function () {\n          setFieldSelection(searchField)\n        })\n      })\n\n      $scope.$on('search_clear', function () {\n        $(panelWrap).removeClass('im_dialogs_panel_search')\n        $scope.$broadcast('ui_dialogs_search')\n      })\n\n      $(document).on('keydown', onKeyDown)\n\n      $scope.$on('$destroy', function () {\n        $(document).off('keydown', onKeyDown)\n      })\n\n      $scope.$on('ui_dialogs_change', function () {\n        onContentLoaded(function () {\n          var selectedDialog = $(scrollableWrap).find('.active a.im_dialog')[0]\n          if (selectedDialog) {\n            scrollToNode(scrollableWrap, selectedDialog.parentNode, dialogsWrap)\n          }\n        })\n      })\n\n      function onKeyDown (e) {\n        if (!searchFocused && $modalStack.getTop()) {\n          return true\n        }\n\n        if (e.keyCode == 36 && !e.shiftKey && !e.ctrlKey && e.altKey) { // Alt + Home\n          var currentSelected = $(scrollableWrap).find('.im_dialog_wrap a')\n          if (currentSelected.length) {\n            $(currentSelected[0]).trigger('mousedown')\n            scrollableWrap.scrollTop = 0\n            $(dialogsWrap).nanoScroller({flash: true})\n          }\n          return cancelEvent(e)\n        }\n\n        if (e.keyCode == 27 || e.keyCode == 9 && e.shiftKey && !e.ctrlKey && !e.metaKey) { // ESC or Shift + Tab\n          if (!searchFocused) {\n            setFieldSelection(searchField)\n            if (searchField.value) {\n              searchField.select()\n            }\n          }\n          else if (searchField.value) {\n            $(searchClear).trigger('click')\n          }else {\n            $scope.$emit('esc_no_more')\n            // Strange Chrome bug, when field doesn't get blur, but becomes inactive after location change\n            setTimeout(function () {\n              searchField.blur()\n              searchField.focus()\n            }, 100)\n          }\n          return cancelEvent(e)\n        }\n\n        if (searchFocused && e.keyCode == 13 && !Config.Navigator.mobile) { // Enter\n          var currentSelected = $(scrollableWrap).find('.im_dialog_selected')[0] || $(scrollableWrap).find('.im_dialog_wrap a')[0]\n          if (currentSelected) {\n            $(currentSelected).trigger('mousedown')\n          }\n          return cancelEvent(e)\n        }\n\n        if (\n          (!Config.Navigator.osX && // No Mac users\n              e.altKey && e.shiftKey && !e.ctrlKey && !e.metaKey &&\n              e.keyCode >= 49 && e.keyCode <= 57 ) // Alt + Shift + # , switch to conversation # where # is in [1..9]\n          ||\n          (Config.Navigator.osX && // Mac users only\n          e.ctrlKey && e.shiftKey && !e.metaKey && !e.altKey &&\n          e.keyCode >= 49 && e.keyCode <= 57 ) ) { // Ctrl + Shift + # , switch to conversation # where # is in [1..9]\n\n          var dialogNumber = e.keyCode - 49\n          var dialogWraps = $(scrollableWrap).find('.im_dialog_wrap')\n          var nextDialogWrap = dialogWraps[dialogNumber]\n\n          if (nextDialogWrap) {\n            $(nextDialogWrap).find('a').trigger('mousedown')\n            scrollToNode(scrollableWrap, nextDialogWrap, dialogsWrap)\n          }\n\n          return cancelEvent(e)\n        }\n\n        var next\n        var prev, skip\n        var ctrlTabSupported = Config.Modes.packed\n        if (e.keyCode == 40 || e.keyCode == 38) { // UP, DOWN\n          next = e.keyCode == 40\n          prev = !next\n          skip = !e.shiftKey && e.altKey\n        }\n        else if (ctrlTabSupported && e.keyCode == 9 && e.ctrlKey && !e.metaKey) { // Ctrl + Tab, Shift + Ctrl + Tab\n          next = !e.shiftKey\n          prev = !next\n          skip = true\n        }\n\n        if (next || prev) {\n          if (!skip && (!searchFocused || e.metaKey)) {\n            return true\n          }\n\n          var currentSelected = !skip && $(scrollableWrap).find('.im_dialog_selected')[0] || $(scrollableWrap).find('.active a.im_dialog')[0]\n          var currentSelectedWrap = currentSelected && currentSelected.parentNode,\n            nextDialogWrap\n\n          if (currentSelectedWrap) {\n            var nextDialogWrap = currentSelected[next ? 'nextSibling' : 'previousSibling']\n\n            if (!nextDialogWrap || !nextDialogWrap.className || nextDialogWrap.className.indexOf('im_dialog_wrap') == -1) {\n              var dialogWraps = $(scrollableWrap).find('.im_dialog_wrap')\n              var pos = dialogWraps.index(currentSelected.parentNode)\n              var nextPos = pos + (next ? 1 : -1)\n\n              nextDialogWrap = dialogWraps[nextPos]\n            }\n          } else {\n            var dialogWraps = $(scrollableWrap).find('.im_dialog_wrap')\n            if (next) {\n              nextDialogWrap = dialogWraps[0]\n            } else {\n              nextDialogWrap = dialogWraps[dialogWraps.length - 1]\n            }\n          }\n\n          if (skip) {\n            if (nextDialogWrap) {\n              $(nextDialogWrap).find('a').trigger('mousedown')\n            }\n          } else {\n            if (currentSelectedWrap && nextDialogWrap) {\n              $(currentSelectedWrap).find('a').removeClass('im_dialog_selected')\n            }\n            if (nextDialogWrap) {\n              $(nextDialogWrap).find('a').addClass('im_dialog_selected')\n            }\n          }\n\n          if (nextDialogWrap) {\n            scrollToNode(scrollableWrap, nextDialogWrap, dialogsWrap)\n          }\n\n          return cancelEvent(e)\n        }\n      }\n    }\n  })\n\n  .directive('myDialogsList', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var dialogsWrap = $('.im_dialogs_wrap', element)[0]\n      var dialogsColWrap = $('.im_dialogs_col_wrap')[0]\n      var scrollableWrap = $('.im_dialogs_scrollable_wrap', element)[0]\n      var headWrap = $('.tg_page_head')[0]\n      var panelWrapSelector = Config.Mobile && attrs.modal\n        ? '.mobile_modal_body .im_dialogs_panel'\n        : '.im_dialogs_panel'\n      var panelWrap = $(panelWrapSelector)[0]\n      var footer = $('.footer_wrap')[0]\n      var moreNotified = false\n\n      onContentLoaded(function () {\n        $(dialogsWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n      })\n\n      var updateScroller = function () {\n        onContentLoaded(function () {\n          $(dialogsWrap).nanoScroller()\n        })\n      }\n\n      $scope.$on('ui_dialogs_prepend', updateScroller)\n      $scope.$on('ui_dialogs_search', updateSizes)\n      $scope.$on('ui_dialogs_update', updateSizes)\n\n      $scope.$on('ui_dialogs_append', function () {\n        onContentLoaded(function () {\n          updateScroller()\n          moreNotified = false\n\n          $timeout(function () {\n            $(scrollableWrap).trigger('scroll')\n          })\n        })\n      })\n\n      $scope.$on('ui_dialogs_change', function () {\n        onContentLoaded(function () {\n          updateScroller()\n          moreNotified = false\n\n          $timeout(function () {\n            $(scrollableWrap).trigger('scroll')\n          })\n        })\n      })\n\n      $(scrollableWrap).on('scroll', function (e) {\n        if (!element.is(':visible')) return\n        // console.log('scroll', moreNotified)\n        if (!moreNotified && scrollableWrap.scrollTop >= scrollableWrap.scrollHeight - scrollableWrap.clientHeight - 300) {\n          // console.log('emit need more')\n          $scope.$emit('dialogs_need_more')\n          moreNotified = true\n        }\n      })\n\n      function updateSizes () {\n        if (!panelWrap || !panelWrap.offsetHeight) {\n          panelWrap = $(panelWrapSelector)[0]\n        }\n\n        if (attrs.modal) {\n          var height = $($window).height() -\n          (panelWrap ? panelWrap.offsetHeight : 49) -\n          (Config.Mobile ? 46 : 100)\n          height = Math.min(Config.Mobile ? 350 : 450, height)\n          $(element).css({height: height})\n          updateScroller()\n          return\n        }\n\n        if (!headWrap || !headWrap.offsetHeight) {\n          headWrap = $('.tg_page_head')[0]\n        }\n        if (!footer || !footer.offsetHeight) {\n          footer = $('.footer_wrap')[0]\n        }\n\n        if (!dialogsColWrap || !dialogsColWrap.offsetHeight) {\n          dialogsColWrap = $('.im_dialogs_col_wrap')[0]\n        }\n        var footerHeight = footer ? footer.offsetHeight : 0\n        if (footerHeight) {\n          footerHeight++ // Border bottom\n        }\n        $(element).css({\n          height: $($window).height() -\n            footerHeight -\n            (headWrap ? headWrap.offsetHeight : 48) -\n            (panelWrap ? panelWrap.offsetHeight : 58) -\n            parseInt($(dialogsColWrap).css('paddingBottom') || 0)\n        })\n\n        updateScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n\n      updateSizes()\n      setTimeout(updateSizes, 1000)\n    }\n  })\n\n  .directive('myContactsList', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var searchWrap = $('.contacts_modal_search')[0]\n      var panelWrap = $('.contacts_modal_panel')[0]\n      var contactsWrap = $('.contacts_wrap', element)[0]\n\n      onContentLoaded(function () {\n        $(contactsWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n        updateSizes()\n      })\n\n      function updateSizes () {\n        $(element).css({\n          height: $($window).height() -\n            (panelWrap && panelWrap.offsetHeight || 0) -\n            (searchWrap && searchWrap.offsetHeight || 0) -\n            (Config.Mobile ? 64 : 200)\n        })\n        $(contactsWrap).nanoScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n      $scope.$on('contacts_change', function () {\n        onContentLoaded(updateSizes)\n      })\n    }\n  })\n\n  .directive('myCountriesList', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var searchWrap = $('.countries_modal_search')[0]\n      var panelWrap = $('.countries_modal_panel')[0]\n      var countriesWrap = $('.countries_wrap', element)[0]\n\n      onContentLoaded(function () {\n        $(countriesWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n        updateSizes()\n      })\n\n      function updateSizes () {\n        $(element).css({\n          height: $($window).height()\n            - (panelWrap && panelWrap.offsetHeight || 0)\n            - (searchWrap && searchWrap.offsetHeight || 0)\n            - (Config.Mobile ? 46 + 18 : 200)\n        })\n        $(countriesWrap).nanoScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n      $scope.$on('contacts_change', function () {\n        onContentLoaded(updateSizes)\n      })\n    }\n  })\n\n  .directive('mySessionsList', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var sessionsWrap = $('.sessions_wrap', element)[0]\n\n      onContentLoaded(function () {\n        $(sessionsWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n        updateSizes()\n      })\n\n      function updateSizes () {\n        $(element).css({\n          height: Math.min(760, $($window).height()\n            - (Config.Mobile ? 46 + 18 : 200))\n        })\n        $(sessionsWrap).nanoScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n    }\n  })\n\n  .directive('myStickersList', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var stickersWrap = $('.stickerset_wrap', element)[0]\n\n      onContentLoaded(function () {\n        $(stickersWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n        updateSizes()\n      })\n\n      function updateSizes () {\n        $(element).css({\n          height: Math.min(600, $($window).height()\n            - (Config.Mobile ? 46 + 18 : 200))\n        })\n        $(stickersWrap).nanoScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n    }\n  })\n\n  .directive('myHistory', function ($window, $timeout, $rootScope, $transition) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var historyWrap = $('.im_history_wrap', element)[0]\n      var historyMessagesEl = $('.im_history_messages', element)[0]\n      var historyEl = $('.im_history', element)[0]\n      var scrollableWrap = $('.im_history_scrollable_wrap', element)[0]\n      var scrollable = $('.im_history_scrollable', element)[0]\n      var emptyWrapEl = $('.im_history_empty_wrap', element)[0]\n      var bottomPanelWrap = $('.im_bottom_panel_wrap', element)[0]\n      var sendFormWrap = $('.im_send_form_wrap', element)[0]\n      var headWrap = $('.tg_page_head')[0]\n      var footer = $('.footer_wrap')[0]\n      var sendForm = $('.im_send_form', element)[0]\n      var moreNotified = false\n      var lessNotified = false\n\n      onContentLoaded(function () {\n        scrollableWrap.scrollTop = scrollableWrap.scrollHeight\n      })\n      $(historyWrap).nanoScroller({preventPageScrolling: true, tabIndex: -1, iOSNativeScrolling: true})\n\n      var updateScroller = function (delay) {\n        // console.trace('scroller update', delay)\n        $timeout(function () {\n          if (!$(scrollableWrap).hasClass('im_history_to_bottom')) {\n            $(historyWrap).nanoScroller()\n          }\n        }, delay || 0)\n      }\n\n      var transform = false\n      var trs = ['transform', 'webkitTransform', 'MozTransform', 'msTransform', 'OTransform'],\n        i\n      for (i = 0; i < trs.length; i++) {\n        if (trs[i] in historyMessagesEl.style) {\n          transform = trs[i]\n          break\n        }\n      }\n\n      var animated = transform && false ? true : false\n      var curAnimation = false\n\n      $scope.$on('ui_history_append_new', function (e, options) {\n        if (!atBottom && !options.my) {\n          onContentLoaded(function () {\n            $(historyWrap).nanoScroller()\n          })\n          return\n        }\n        if (options.idleScroll) {\n          onContentLoaded(function () {\n            $(historyWrap).nanoScroller()\n            changeScroll(true)\n          })\n          return\n        }\n        var curAnimated = animated &&\n            !$rootScope.idle.isIDLE &&\n            historyMessagesEl.clientHeight > 0,\n          wasH\n\n        if (curAnimated) {\n          wasH = scrollableWrap.scrollHeight\n        } else {\n          var pr = parseInt($(scrollableWrap).css('paddingRight'))\n          $(scrollable).css({bottom: 0, paddingRight: pr})\n          $(scrollableWrap).addClass('im_history_to_bottom')\n        }\n\n        onContentLoaded(function () {\n          if (curAnimated) {\n            curAnimation = true\n            $(historyMessagesEl).removeClass('im_history_appending')\n            scrollableWrap.scrollTop = scrollableWrap.scrollHeight\n            $(historyMessagesEl).css(transform, 'translate(0px, ' + (scrollableWrap.scrollHeight - wasH) + 'px)')\n            $(historyWrap).nanoScroller()\n            var styles = {}\n            styles[transform] = 'translate(0px, 0px)'\n            $(historyMessagesEl).addClass('im_history_appending')\n            $transition($(historyMessagesEl), styles).then(function () {\n              curAnimation = false\n              $(historyMessagesEl).removeClass('im_history_appending')\n              updateBottomizer()\n            })\n          } else {\n            $(scrollableWrap).removeClass('im_history_to_bottom')\n            $(scrollable).css({bottom: '', paddingRight: 0})\n            scrollableWrap.scrollTop = scrollableWrap.scrollHeight\n            updateBottomizer()\n          }\n        })\n      })\n\n      function changeScroll (noFocus, animated) {\n        var unreadSplit\n        var focusMessage\n\n        var newScrollTop = false\n        var afterScrollAdd\n        // console.trace(dT(), 'change scroll', animated)\n        if (!noFocus &&\n          (focusMessage = $('.im_message_focus:visible', scrollableWrap)[0])) {\n          // console.log(dT(), 'change scroll to focus', focusMessage)\n          var ch = scrollableWrap.clientHeight\n          var st = scrollableWrap.scrollTop\n          var ot = focusMessage.offsetTop\n          var h = focusMessage.clientHeight\n          if (!st || st + ch < ot || st > ot + h || animated) {\n            newScrollTop = Math.max(0, ot - Math.floor(ch / 2) + 26)\n          }\n          atBottom = false\n\n          afterScrollAdd = function () {\n            var unfocusMessagePromise = $(focusMessage).data('unfocus_promise')\n            if (unfocusMessagePromise) {\n              $timeout.cancel(unfocusMessagePromise)\n              $(focusMessage).removeClass('im_message_focus_active')\n            }\n            $timeout(function () {\n              $(focusMessage).addClass('im_message_focus_active')\n              unfocusMessagePromise = $timeout(function () {\n                $(focusMessage).removeClass('im_message_focus_active')\n                $(focusMessage).data('unfocus_promise', false)\n              }, 2800)\n              $(focusMessage).data('unfocus_promise', unfocusMessagePromise)\n            })\n          }\n        } else if (unreadSplit = $('.im_message_unread_split:visible', scrollableWrap)[0]) {\n          // console.log(dT(), 'change scroll unread', unreadSplit.offsetTop)\n          newScrollTop = Math.max(0, unreadSplit.offsetTop - 52)\n          atBottom = false\n        } else {\n          // console.log(dT(), 'change scroll bottom')\n          newScrollTop = scrollableWrap.scrollHeight\n          atBottom = true\n        }\n        if (newScrollTop !== false) {\n          var afterScroll = function () {\n            updateScroller()\n            $timeout(function () {\n              $(scrollableWrap).trigger('scroll')\n              scrollTopInitial = scrollableWrap.scrollTop\n            })\n            if (afterScrollAdd) {\n              afterScrollAdd()\n            }\n          }\n          if (animated) {\n            $(scrollableWrap).animate({scrollTop: newScrollTop}, 200, afterScroll)\n          } else {\n            scrollableWrap.scrollTop = newScrollTop\n            afterScroll()\n          }\n        }\n      }\n\n      $scope.$on('ui_history_change', function () {\n        var pr = parseInt($(scrollableWrap).css('paddingRight'))\n        $(scrollableWrap).addClass('im_history_to_bottom')\n        scrollableWrap.scrollHeight // Some strange Chrome bug workaround\n        $(scrollable).css({bottom: 0, paddingRight: pr})\n        onContentLoaded(function () {\n          $(scrollableWrap).removeClass('im_history_to_bottom')\n          $(scrollable).css({bottom: '', paddingRight: ''})\n          updateSizes(true)\n          moreNotified = false\n          lessNotified = false\n          changeScroll()\n        })\n      })\n\n      $scope.$on('ui_history_change_scroll', function (e, animated) {\n        onContentLoaded(function () {\n          changeScroll(false, animated)\n        })\n      })\n\n      $scope.$on('ui_history_focus', function () {\n        if (!atBottom) {\n          // console.log(dT(), 'scroll history focus')\n          scrollableWrap.scrollTop = scrollableWrap.scrollHeight\n          updateScroller()\n          atBottom = true\n        }\n      })\n\n      $scope.$on('ui_history_prepend', function () {\n        var sh = scrollableWrap.scrollHeight\n        var st = scrollableWrap.scrollTop\n        var pr = parseInt($(scrollableWrap).css('paddingRight'))\n        var ch = scrollableWrap.clientHeight\n\n        $(scrollableWrap).addClass('im_history_to_bottom')\n        scrollableWrap.scrollHeight // Some strange Chrome bug workaround\n        $(scrollable).css({bottom: -(sh - st - ch), paddingRight: pr})\n\n        var upd = function () {\n            $(scrollableWrap).removeClass('im_history_to_bottom')\n            $(scrollable).css({bottom: '', paddingRight: ''})\n            if (scrollTopInitial >= 0) {\n              changeScroll()\n            } else {\n              // console.log('change scroll prepend')\n              scrollableWrap.scrollTop = st + scrollableWrap.scrollHeight - sh\n            }\n\n            updateBottomizer()\n            moreNotified = false\n\n            $timeout(function () {\n              if (scrollableWrap.scrollHeight != sh) {\n                $(scrollableWrap).trigger('scroll')\n              }\n            })\n\n            clearTimeout(timer)\n            unreg()\n          },\n          timer = setTimeout(upd, 0),\n          unreg = $scope.$on('$viewContentLoaded', upd)\n      })\n\n      $scope.$on('ui_history_append', function () {\n        var sh = scrollableWrap.scrollHeight\n        onContentLoaded(function () {\n          atBottom = false\n          updateBottomizer()\n          lessNotified = false\n\n          if (scrollTopInitial >= 0) {\n            changeScroll()\n          }\n\n          $timeout(function () {\n            if (scrollableWrap.scrollHeight != sh) {\n              $(scrollableWrap).trigger('scroll')\n            }\n          })\n        })\n      })\n\n      $scope.$on('ui_panel_update', function (e, data) {\n        updateSizes()\n        onContentLoaded(function () {\n          updateSizes()\n          if (data && data.blur) {\n            $scope.$broadcast('ui_message_blur')\n          } else if (!getSelectedText()) {\n            $scope.$broadcast('ui_message_send')\n          }\n\n          $timeout(function () {\n            $(scrollableWrap).trigger('scroll')\n          })\n        })\n      })\n\n      $scope.$on('ui_selection_clear', function () {\n        if (window.getSelection) {\n          if (window.getSelection().empty) { // Chrome\n            window.getSelection().empty()\n          } else if (window.getSelection().removeAllRanges) { // Firefox\n            window.getSelection().removeAllRanges()\n          }\n        } else if (document.selection) { // IE?\n          document.selection.empty()\n        }\n      })\n\n      $scope.$on('ui_editor_resize', updateSizes)\n      $scope.$on('ui_height', function () {\n        onContentLoaded(updateSizes)\n      // updateSizes()\n      })\n\n      var atBottom = true\n      var scrollTopInitial = -1\n      $(scrollableWrap).on('scroll', function (e) {\n        if (!element.is(':visible') ||\n          $(scrollableWrap).hasClass('im_history_to_bottom') ||\n          curAnimation) {\n          return\n        }\n        var st = scrollableWrap.scrollTop\n        atBottom = st >= scrollableWrap.scrollHeight - scrollableWrap.clientHeight\n        if (scrollTopInitial >= 0 && scrollTopInitial != st) {\n          scrollTopInitial = -1\n        }\n\n        if (!moreNotified && st <= 300) {\n          moreNotified = true\n          $scope.$emit('history_need_more')\n        }\n        else if (!lessNotified && st >= scrollableWrap.scrollHeight - scrollableWrap.clientHeight - 300) {\n          lessNotified = true\n          $scope.$emit('history_need_less')\n        }\n      })\n\n      function updateSizes (heightOnly) {\n        if (!element.is(':visible') && !$(element[0].parentNode.parentNode).is(':visible')) {\n          return\n        }\n        if ($(sendFormWrap).is(':visible')) {\n          $(sendFormWrap).css({\n            height: $(sendForm).height()\n          })\n        }\n\n        if (!headWrap || !headWrap.offsetHeight) {\n          headWrap = $('.tg_page_head')[0]\n        }\n        if (!footer || !footer.offsetHeight) {\n          footer = $('.footer_wrap')[0]\n        }\n        var footerHeight = footer ? footer.offsetHeight : 0\n        if (footerHeight) {\n          footerHeight++ // Border bottom\n        }\n        var historyH = $($window).height() - bottomPanelWrap.offsetHeight - (headWrap ? headWrap.offsetHeight : 48) - footerHeight\n        $(historyWrap).css({\n          height: historyH\n        })\n\n        updateBottomizer()\n\n        if (heightOnly === true) return\n        if (atBottom) {\n          onContentLoaded(function () {\n            // console.log('change scroll bottom')\n            scrollableWrap.scrollTop = scrollableWrap.scrollHeight\n            updateScroller()\n          })\n        }\n        updateScroller(100)\n      }\n\n      function updateBottomizer () {\n        $(historyMessagesEl).css({marginTop: 0})\n        var marginTop = scrollableWrap.offsetHeight\n        - historyMessagesEl.offsetHeight\n        - emptyWrapEl.offsetHeight\n        - (Config.Mobile ? 0 : 39)\n\n        if (historyMessagesEl.offsetHeight > 0 && marginTop > 0) {\n          $(historyMessagesEl).css({marginTop: marginTop})\n        }\n        $(historyWrap).nanoScroller()\n      }\n\n      $($window).on('resize', updateSizes)\n\n      updateSizes()\n      onContentLoaded(updateSizes)\n    }\n  })\n\n  .directive('mySendForm', function (_, $q, $timeout, $compile, $modalStack, $http, $interpolate, Storage, AppStickersManager, AppDocsManager, ErrorService, AppInlineBotsManager, FileManager, shouldFocusOnInteraction) {\n    return {\n      link: link,\n      scope: {\n        draftMessage: '=',\n        mentions: '=',\n        commands: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var messageField = $('textarea', element)[0]\n      var emojiButton = $('.composer_emoji_insert_btn', element)[0]\n      var emojiPanel = $('.composer_emoji_panel', element)[0]\n      var fileSelects = $('input', element)\n      var dropbox = $('.im_send_dropbox_wrap', element)[0]\n      var messageFieldWrap = $('.im_send_field_wrap', element)[0]\n      var dragStarted\n      var dragTimeout\n      var submitBtn = $('.im_submit', element)[0]\n\n      var stickerImageCompiled = $compile('<a class=\"composer_sticker_btn\" data-sticker=\"{{::document.id}}\" my-load-sticker document=\"document\" thumb=\"true\" img-class=\"composer_sticker_image\"></a>')\n      var cachedStickerImages = {}\n\n      var emojiTooltip = new EmojiTooltip(emojiButton, {\n        getStickers: function (callback) {\n          AppStickersManager.getStickers().then(callback)\n        },\n        getStickerImage: function (element, docID) {\n          var category = element.attr('data-category')\n          var cached = cachedStickerImages[docID]\n          if (cached && !isInDOM(cached[0])) {\n            cached.attr('data-category', category)\n            element.replaceWith(cached)\n            return\n          }\n          var scope = $scope.$new(true)\n          scope.document = AppDocsManager.getDoc(docID)\n          stickerImageCompiled(scope, function (clonedElement) {\n            cachedStickerImages[docID] = clonedElement\n            clonedElement.attr('data-category', category)\n            element.replaceWith(clonedElement)\n          })\n        },\n        onStickersetSelected: function (stickerset) {\n          AppStickersManager.openStickersetLink(stickerset)\n        },\n        onEmojiSelected: function (code) {\n          $scope.$apply(function () {\n            composer.onEmojiSelected(code)\n          })\n        },\n        onStickerSelected: function (docID) {\n          $scope.$apply(function () {\n            $scope.draftMessage.sticker = docID\n          })\n        },\n        langpack: {\n          im_emoji_tab: _('im_emoji_tab'),\n          im_stickers_tab: _('im_stickers_tab')\n        }\n      })\n\n      $scope.$on('stickers_changed', function () {\n        emojiTooltip.onStickersChanged()\n      })\n\n      var composerEmojiPanel\n      if (emojiPanel) {\n        composerEmojiPanel = new EmojiPanel(emojiPanel, {\n          onEmojiSelected: function (code) {\n            composer.onEmojiSelected(code)\n          }\n        })\n      }\n\n      var composer = new MessageComposer(messageField, {\n        onTyping: function () {\n          $scope.$emit('ui_typing')\n        },\n        getSendOnEnter: function () {\n          return sendOnEnter\n        },\n        dropdownDirective: function (element, callback) {\n          var scope = $scope.$new(true)\n          var clonedElement = $compile('<div><div my-composer-dropdown></div></div>')(scope, function (clonedElement, scope) {\n            element.replaceWith(clonedElement)\n            callback(scope, clonedElement)\n          })\n        },\n        mentions: $scope.mentions,\n        commands: $scope.commands,\n        onMessageSubmit: onMessageSubmit,\n        onInlineResultSend: onInlineResultSend,\n        onFilePaste: onFilePaste,\n        onCommandSend: function (command) {\n          $scope.$apply(function () {\n            $scope.draftMessage.command = command\n          })\n        }\n      })\n\n      var richTextarea = composer.richTextareaEl && composer.richTextareaEl[0]\n      if (richTextarea) {\n        $(richTextarea).on('keydown keyup', updateHeight)\n      }\n\n      $scope.$on('inline_results', function (e, inlineResults) {\n        var w = Config.Mobile ? $(window).width() : (messageFieldWrap.offsetWidth || 382) - 2\n        var h = 80\n        if (inlineResults) {\n          AppInlineBotsManager.regroupWrappedResults(inlineResults.results, w, h)\n        }\n        setZeroTimeout(function () {\n          composer.setInlineSuggestions(inlineResults)\n        })\n      })\n\n      $scope.$on('inline_placeholder', function (e, data) {\n        composer.setInlinePlaceholder(data.prefix, data.placeholder)\n      })\n\n      fileSelects.on('change', function () {\n        var self = this\n        $scope.$apply(function () {\n          $scope.draftMessage.files = Array.prototype.slice.call(self.files)\n          $scope.draftMessage.isMedia = $(self).hasClass('im_media_attach_input') || Config.Mobile\n          setTimeout(function () {\n            try {\n              self.value = ''\n            } catch (e) {}\n          }, 1000)\n        })\n      })\n\n      var sendOnEnter = true\n      function updateSendSettings () {\n        Storage.get('send_ctrlenter').then(function (sendOnCtrl) {\n          sendOnEnter = !sendOnCtrl\n        })\n      }\n      $scope.$on('settings_changed', updateSendSettings)\n      updateSendSettings()\n\n      $(submitBtn).on('mousedown touchstart', onMessageSubmit)\n\n      function onMessageSubmit (e) {\n        $timeout(function () {\n          updateValue()\n          $scope.draftMessage.send()\n          composer.resetTyping()\n          if (composerEmojiPanel) {\n            composerEmojiPanel.update()\n          }\n\n          composer.hideSuggestions()\n        }, shouldFocusOnInteraction ? 0 : 100)\n        return cancelEvent(e)\n      }\n\n      function onInlineResultSend (qID) {\n        $scope.$apply(function () {\n          $scope.draftMessage.inlineResultID = qID\n        })\n      }\n\n      function updateValue () {\n        if (richTextarea) {\n          composer.onChange()\n          updateHeight()\n        }\n      }\n\n      var height = richTextarea && richTextarea.offsetHeight\n      function updateHeight () {\n        var newHeight = richTextarea.offsetHeight\n        if (height != newHeight) {\n          height = newHeight\n          $scope.$emit('ui_editor_resize')\n        }\n      }\n\n      function onKeyDown (e) {\n        if (e.keyCode == 9 && !e.shiftKey && !e.ctrlKey && !e.metaKey && !$modalStack.getTop()) { // TAB\n          composer.focus()\n          return cancelEvent(e)\n        }\n      }\n      $(document).on('keydown', onKeyDown)\n\n      $('body').on('dragenter dragleave dragover drop', onDragDropEvent)\n      $(document).on('paste', onPasteEvent)\n\n      if (shouldFocusOnInteraction) {\n        $scope.$on('ui_peer_change', focusField)\n        $scope.$on('ui_history_focus', focusField)\n        $scope.$on('ui_history_change', focusField)\n      }\n\n      $scope.$on('ui_peer_change', composer.resetTyping.bind(composer))\n      $scope.$on('ui_peer_draft', function (e, options) {\n        options = options || {}\n        var isBroadcast = $scope.draftMessage.isBroadcast\n        composer.setPlaceholder(_(isBroadcast ? 'im_broadcast_field_placeholder_raw' : 'im_message_field_placeholder_raw'))\n\n        if (options.customSelection) {\n          composer.setFocusedValue(options.customSelection)\n          updateHeight()\n        } else {\n          if (richTextarea) {\n            composer.setValue($scope.draftMessage.text || '')\n            updateHeight()\n          }\n          if (shouldFocusOnInteraction || options && options.focus) {\n            composer.focus()\n          }\n        }\n        onContentLoaded(function () {\n          composer.checkAutocomplete(true)\n        })\n        if (emojiTooltip && Config.Mobile) {\n          emojiTooltip.hide()\n        }\n      })\n      $scope.$on('ui_peer_reply', function () {\n        onContentLoaded(function () {\n          $scope.$emit('ui_editor_resize')\n          if (shouldFocusOnInteraction) {\n            composer.focus()\n          }\n        })\n      })\n\n      $scope.$on('mentions_update', function () {\n        composer.onMentionsUpdated()\n      })\n\n      $scope.$on('ui_message_before_send', function () {\n        updateValue()\n      })\n      $scope.$on('ui_message_send', function () {\n        if (shouldFocusOnInteraction) {\n          focusField()\n        }\n      })\n      $scope.$on('ui_message_blur', function () {\n        composer.blur()\n      })\n\n      function focusField () {\n        onContentLoaded(function () {\n          composer.focus()\n        })\n      }\n\n      function onFilePaste (blob) {\n        var mimeType = blob.type || ''\n        var fileUrlPromise = $q.when(false)\n        if (['image/jpeg', 'image/gif', 'image/png', 'image/bmp'].indexOf(mimeType) >= 0) {\n          fileUrlPromise = FileManager.getFileCorrectUrl(blob, mimeType)\n        }\n        fileUrlPromise.then(function (fileUrl) {\n          fileUrl = fileUrl || false\n          ErrorService.confirm({type: 'FILE_CLIPBOARD_PASTE', fileUrl: fileUrl}).then(function () {\n            $scope.draftMessage.files = [blob]\n            $scope.draftMessage.isMedia = true\n          })\n        })\n      }\n\n      function onPasteEvent (e) {\n        var cData = (e.originalEvent || e).clipboardData\n        var items = cData && cData.items || []\n        var files = [],\n          file\n        var i\n\n        for (i = 0; i < items.length; i++) {\n          if (items[i].kind == 'file') {\n            file = items[i].getAsFile()\n            files.push(file)\n          }\n        }\n\n        if (files.length > 0) {\n          if (files.length == 1) {\n            return onFilePaste(files[0])\n          }\n          ErrorService.confirm({type: 'FILES_CLIPBOARD_PASTE', files: files}).then(function () {\n            $scope.draftMessage.files = files\n            $scope.draftMessage.isMedia = true\n          })\n        }\n      }\n\n      function onDragDropEvent (e) {\n        var dragStateChanged = false\n        if (!dragStarted || dragStarted == 1) {\n          dragStarted = checkDragEvent(e) ? 2 : 1\n          dragStateChanged = true\n        }\n        if (dragStarted == 2) {\n          if (dragTimeout) {\n            setTimeout(function () {\n              clearTimeout(dragTimeout)\n              dragTimeout = false\n            }, 0)\n          }\n\n          if (e.type == 'dragenter' || e.type == 'dragover') {\n            if (dragStateChanged) {\n              if (!Config.Mobile) {\n                $(emojiButton).hide()\n              }\n              $(dropbox)\n                .css({height: messageFieldWrap.offsetHeight + 2, width: messageFieldWrap.offsetWidth})\n                .show()\n            }\n          } else {\n            if (e.type == 'drop') {\n              $scope.$apply(function () {\n                $scope.draftMessage.files = Array.prototype.slice.call(e.originalEvent.dataTransfer.files)\n                $scope.draftMessage.isMedia = true\n              })\n            }\n            dragTimeout = setTimeout(function () {\n              $(dropbox).hide()\n              if (!Config.Mobile) {\n                $(emojiButton).show()\n              }\n              dragStarted = false\n              dragTimeout = false\n            }, 300)\n          }\n        }\n\n        return cancelEvent(e)\n      }\n\n      $scope.$on('$destroy', function cleanup () {\n        $(document).off('paste', onPasteEvent)\n        $(document).off('keydown', onKeyDown)\n        $('body').off('dragenter dragleave dragover drop', onDragDropEvent)\n        $(submitBtn).off('mousedown touchstart')\n        fileSelects.off('change')\n      })\n\n      if (shouldFocusOnInteraction) {\n        focusField()\n      }\n    }\n  })\n\n  .directive('myLoadThumb', function (MtpApiFileManager, FileManager) {\n    return {\n      link: link,\n      scope: {\n        thumb: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var counter = 0\n\n      var cachedBlob = MtpApiFileManager.getCachedFile(\n        $scope.thumb &&\n        $scope.thumb.location &&\n        !$scope.thumb.location.empty &&\n        $scope.thumb.location\n      )\n\n      if (cachedBlob) {\n        element.attr('src', FileManager.getUrl(cachedBlob, 'image/jpeg'))\n      }\n      if ($scope.thumb && $scope.thumb.width && $scope.thumb.height) {\n        element.attr('width', $scope.thumb.width)\n        element.attr('height', $scope.thumb.height)\n      }\n\n      var stopWatching = $scope.$watchCollection('thumb.location', function (newLocation) {\n        if ($scope.thumb && $scope.thumb.width && $scope.thumb.height) {\n          element.attr('width', $scope.thumb.width)\n          element.attr('height', $scope.thumb.height)\n          $scope.$emit('ui_height')\n        }\n        // console.log('new loc', newLocation, arguments)\n        var counterSaved = ++counter\n        if (!newLocation || newLocation.empty) {\n          element.attr('src', $scope.thumb && $scope.thumb.placeholder || 'img/blank.gif')\n          cleanup()\n          return\n        }\n\n        var cachedBlob = MtpApiFileManager.getCachedFile(newLocation)\n        if (cachedBlob) {\n          element.attr('src', FileManager.getUrl(cachedBlob, 'image/jpeg'))\n          cleanup()\n          return\n        }\n\n        if (!element.attr('src')) {\n          element.attr('src', $scope.thumb.placeholder || 'img/blank.gif')\n        }\n\n        MtpApiFileManager.downloadSmallFile($scope.thumb.location).then(function (blob) {\n          if (counterSaved == counter) {\n            element.attr('src', FileManager.getUrl(blob, 'image/jpeg'))\n            cleanup()\n          }\n        }, function (e) {\n          console.log('Download image failed', e, $scope.thumb.location, element[0])\n          if (counterSaved == counter) {\n            element.attr('src', $scope.thumb.placeholder || 'img/blank.gif')\n            cleanup()\n          }\n        })\n      })\n\n      var cleanup = attrs.watch\n        ? angular.noop\n        : function () {\n          setTimeout(function () {\n            $scope.$destroy()\n            stopWatching()\n          }, 0)\n        }\n    }\n  })\n\n  .directive('myLoadFullPhoto', function (MtpApiFileManager, FileManager, _) {\n    return {\n      link: link,\n      transclude: true,\n      templateUrl: templateUrl('full_photo'),\n      scope: {\n        fullPhoto: '=',\n        thumbLocation: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var imgElement = $('img', element)[0]\n      var resizeElements = $('.img_fullsize_with_progress_wrap', element)\n        .add('.img_fullsize_progress_wrap', element)\n        .add($(imgElement))\n      var resize = function () {\n        resizeElements.css({width: $scope.fullPhoto.width, height: $scope.fullPhoto.height})\n        $scope.$emit('ui_height', true)\n      }\n\n      var jump = 0\n      $scope.$watchCollection('fullPhoto.location', function () {\n        var cachedBlob = MtpApiFileManager.getCachedFile($scope.thumbLocation)\n        var curJump = ++jump\n\n        if (cachedBlob) {\n          imgElement.src = FileManager.getUrl(cachedBlob, 'image/jpeg')\n          resize()\n        } else {\n          imgElement.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n        }\n\n        if (!$scope.fullPhoto.location) {\n          return\n        }\n\n        var apiPromise\n        if ($scope.fullPhoto.size) {\n          var inputLocation = {\n            _: 'inputFileLocation',\n            volume_id: $scope.fullPhoto.location.volume_id,\n            local_id: $scope.fullPhoto.location.local_id,\n            secret: $scope.fullPhoto.location.secret\n          }\n          apiPromise = MtpApiFileManager.downloadFile($scope.fullPhoto.location.dc_id, inputLocation, $scope.fullPhoto.size)\n        } else {\n          apiPromise = MtpApiFileManager.downloadSmallFile($scope.fullPhoto.location)\n        }\n\n        $scope.progress = {enabled: true, percent: 0}\n\n        apiPromise.then(function (blob) {\n          if (curJump == jump) {\n            $scope.progress.enabled = false\n            imgElement.src = FileManager.getUrl(blob, 'image/jpeg')\n            resize()\n          }\n        }, function (e) {\n          console.log('Download image failed', e, $scope.fullPhoto.location)\n          $scope.progress.enabled = false\n\n          if (e && e.type == 'FS_BROWSER_UNSUPPORTED') {\n            $scope.error = {html: _('error_browser_no_local_file_system_image_md', {\n                'moz-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>',\n                'chrome-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>',\n                'telegram-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>'\n            })}\n          } else {\n            $scope.error = {text: _('error_image_download_failed'), error: e}\n          }\n        }, function (progress) {\n          $scope.progress.percent = Math.max(1, Math.floor(100 * progress.done / progress.total))\n        })\n      })\n\n      resize()\n    }\n  })\n\n  .directive('myLoadVideo', function ($sce, AppDocsManager, ErrorService, _) {\n    return {\n      link: link,\n      transclude: true,\n      templateUrl: templateUrl('full_video'),\n      scope: {\n        video: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var downloadPromise = AppDocsManager.downloadDoc($scope.video.id)\n\n      downloadPromise.then(function () {\n        $scope.$emit('ui_height')\n        onContentLoaded(function () {\n          var videoEl = $('video', element)[0]\n          if (videoEl) {\n            var errorAlready = false\n            var onVideoError = function (event) {\n              if (errorAlready) {\n                return\n              }\n              if (!event.target ||\n                !event.target.error ||\n                event.target.error.code == event.target.error.MEDIA_ERR_DECODE ||\n                event.target.error.code == event.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n                errorAlready = true\n                ErrorService.show({\n                  error: {\n                    type: 'MEDIA_TYPE_NOT_SUPPORTED',\n                    originalError: event.target && event.target.error\n                  }\n                })\n              }\n            }\n\n            videoEl.addEventListener('error', onVideoError, true)\n            $(videoEl).on('$destroy', function () {\n              errorAlready = true\n              videoEl.removeEventListener('error', onVideoError)\n            })\n          }\n        })\n      }, function (e) {\n        console.log('Download video failed', e, $scope.video)\n\n        if (e && e.type == 'FS_BROWSER_UNSUPPORTED') {\n          $scope.error = {html: _('error_browser_no_local_file_system_video_md', {\n              'moz-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>',\n              'chrome-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>',\n              'telegram-link': '<a href=\"{0}\" target=\"_blank\">{1}</a>'\n          })}\n        } else {\n          $scope.error = {text: _('error_video_download_failed'), error: e}\n        }\n      })\n\n      $scope.$emit('ui_height')\n\n      $scope.$on('$destroy', function () {\n        downloadPromise.cancel()\n      })\n    }\n  })\n\n  .directive('myLoadGif', function (AppDocsManager, $timeout) {\n    return {\n      link: link,\n      templateUrl: templateUrl('full_gif'),\n      scope: {\n        document: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var imgWrap = $('.img_gif_image_wrap', element)\n      imgWrap.css({width: $scope.document.thumb.width, height: $scope.document.thumb.height})\n\n      var downloadPromise = false\n\n      $scope.isActive = false\n\n      // Demo\n      // $scope.document.progress = {enabled: true, percent: 30}\n      // $timeout(function () {\n      //   $scope.document.progress.percent = 60\n      // }, 3000)\n      // $timeout(function () {\n      //   $scope.document.progress.percent = 100\n      // }, 10000)\n\n      $scope.toggle = function (e) {\n        if (e && checkClick(e, true)) {\n          AppDocsManager.saveDocFile($scope.document.id)\n          return false\n        }\n\n        if ($scope.document.url) {\n          onContentLoaded(function () {\n            $scope.isActive = !$scope.isActive\n            $scope.$emit('ui_height')\n\n            var video = $('video', element)[0]\n            if (video) {\n              if (!$scope.isActive) {\n                video.pause()\n                video.currentTime = 0\n              } else {\n                video.play()\n              }\n            }\n          })\n          return\n        }\n\n        if (downloadPromise) {\n          downloadPromise.cancel()\n          downloadPromise = false\n          return\n        }\n\n        downloadPromise = AppDocsManager.downloadDoc($scope.document.id)\n\n        downloadPromise.then(function () {\n          $timeout(function () {\n            $scope.isActive = true\n          }, 200)\n        })\n      }\n\n    // Autoplay small GIFs\n    // if (!Config.Mobile &&\n    //     $scope.document.size &&\n    //     $scope.document.size < 1024 * 1024) {\n    //   $scope.toggle()\n    // }\n    }\n  })\n\n  .directive('myLoadSticker', function (_, MtpApiFileManager, FileManager, AppStickersManager) {\n    var emptySrc = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n\n    return {\n      link: link,\n      scope: {\n        document: '='\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var imgElement = $('<img />').addClass(attrs.imgClass)\n      var wasAdded = false\n\n      imgElement.attr('alt', '[' + ($scope.document.stickerEmojiRaw || '') + ' ' + _('conversation_media_sticker') + ']')\n\n      var dim = attrs.dim && $scope.$parent.$eval(attrs.dim) || $scope.document.thumb\n\n      if (attrs.open && $scope.document.stickerSetInput) {\n        element\n          .addClass('clickable')\n          .on('click', function () {\n            AppStickersManager.openStickerset($scope.document.stickerSetInput)\n          })\n      }\n\n      var setSrc = function (blob) {\n        imgElement.attr('src', FileManager.getUrl(blob))\n        if (!wasAdded) {\n          wasAdded = true\n          imgElement.appendTo(element)\n        }\n      }\n\n      imgElement.css({\n        width: dim.width,\n        height: dim.height\n      })\n      element.css({\n        width: dim.width,\n        height: dim.height\n      })\n\n      var smallLocation = false\n      if ($scope.document.thumb.location) {\n        smallLocation = angular.copy($scope.document.thumb.location)\n        smallLocation.sticker = true\n      }\n\n      var fullLocation = {\n        _: 'inputDocumentFileLocation',\n        id: $scope.document.id,\n        access_hash: $scope.document.access_hash,\n        dc_id: $scope.document.dc_id,\n        file_name: $scope.document.file_name,\n        version: $scope.document.version,\n        sticker: true\n      }\n\n      var cachedBlob = MtpApiFileManager.getCachedFile(fullLocation)\n      var fullDone = false\n      if (!cachedBlob) {\n        cachedBlob = MtpApiFileManager.getCachedFile(smallLocation)\n      } else {\n        fullDone = true\n      }\n      if (cachedBlob) {\n        setSrc(cachedBlob)\n        if (fullDone) {\n          return\n        }\n      } else {\n        wasAdded = true\n        imgElement.attr('src', emptySrc).appendTo(element)\n      }\n\n      if (attrs.thumb && smallLocation) {\n        MtpApiFileManager.downloadSmallFile(smallLocation).then(function (blob) {\n          setSrc(blob)\n        }, function (e) {\n          console.log('Download sticker failed', e, fullLocation)\n        })\n      } else {\n        MtpApiFileManager.downloadFile($scope.document.dc_id, fullLocation, $scope.document.size).then(function (blob) {\n          setSrc(blob)\n        }, function (e) {\n          console.log('Download sticker failed', e, fullLocation)\n        })\n      }\n    }\n  })\n\n  .directive('myLoadDocument', function (MtpApiFileManager, AppDocsManager, FileManager) {\n    return {\n      link: link,\n      templateUrl: templateUrl('full_document'),\n      scope: {\n        document: '=myLoadDocument'\n      }\n    }\n\n    function updateModalWidth (element, width) {\n      while (element && !$(element).hasClass('modal-dialog')) {\n        element = element.parentNode\n      }\n      if (element) {\n        $(element).width(width + (Config.Mobile ? 0 : 32))\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var loaderWrap = $('.document_fullsize_with_progress_wrap', element)\n      var fullSizeWrap = $('.document_fullsize_wrap', element)\n      var fullSizeImage = $('.document_fullsize_img', element)\n\n      var fullWidth = $(window).width() - (Config.Mobile ? 20 : 32)\n      var fullHeight = $(window).height() - 150\n      if (fullWidth > 800) {\n        fullWidth -= 208\n      }\n\n      $scope.imageWidth = fullWidth\n      $scope.imageHeight = fullHeight\n\n      var thumbPhotoSize = $scope.document.thumb\n\n      if (thumbPhotoSize && thumbPhotoSize._ != 'photoSizeEmpty') {\n        var wh = calcImageInBox(thumbPhotoSize.width, thumbPhotoSize.height, fullWidth, fullHeight)\n        $scope.imageWidth = wh.w\n        $scope.imageHeight = wh.h\n\n        var cachedBlob = MtpApiFileManager.getCachedFile(thumbPhotoSize.location)\n        if (cachedBlob) {\n          $scope.thumbSrc = FileManager.getUrl(cachedBlob, 'image/jpeg')\n        }\n      }\n\n      $scope.frameWidth = Math.max($scope.imageWidth, Math.min(600, fullWidth))\n      $scope.frameHeight = $scope.imageHeight\n\n      onContentLoaded(function () {\n        $scope.$emit('ui_height')\n      })\n\n      updateModalWidth(element[0], $scope.frameWidth)\n\n      var checkSizesInt\n      var realImageWidth\n      var realImageHeight\n      AppDocsManager.downloadDoc($scope.document.id).then(function (blob) {\n        var url = FileManager.getUrl(blob, $scope.document.mime_type)\n        var image = new Image()\n        var limit = 100 // 2 sec\n        var checkSizes = function (e) {\n          if ((!image.height || !image.width) && --limit) {\n            return\n          }\n          realImageWidth = image.width\n          realImageHeight = image.height\n          clearInterval(checkSizesInt)\n\n          var defaultWh = calcImageInBox(image.width, image.height, fullWidth, fullHeight, true)\n          var zoomedWh = {w: realImageWidth, h: realImageHeight}\n          if (defaultWh.w >= zoomedWh.w && defaultWh.h >= zoomedWh.h) {\n            zoomedWh.w *= 4\n            zoomedWh.h *= 4\n          }\n\n          var zoomed = true\n          $scope.toggleZoom = function () {\n            zoomed = !zoomed\n            var imageWidth = (zoomed ? zoomedWh : defaultWh).w\n            var imageHeight = (zoomed ? zoomedWh : defaultWh).h\n            fullSizeImage.css({\n              width: imageWidth,\n              height: imageHeight,\n              marginTop: $scope.frameHeight > imageHeight ? Math.floor(($scope.frameHeight - imageHeight) / 2) : 0\n            })\n            fullSizeWrap.toggleClass('document_fullsize_zoomed', zoomed)\n          }\n\n          $scope.toggleZoom(false)\n\n          fullSizeImage.attr('src', url)\n          loaderWrap.hide()\n          fullSizeWrap.css({width: $scope.frameWidth, height: $scope.frameHeight}).show()\n        }\n        checkSizesInt = setInterval(checkSizes, 20)\n        image.onload = checkSizes\n        image.src = url\n        setZeroTimeout(checkSizes)\n      })\n    }\n  })\n\n  .directive('myGeoPointMap', function (ExternalResourcesManager) {\n    return {\n      link: link,\n      scope: {\n        point: '=myGeoPointMap'\n      }\n    }\n\n    function link ($scope, element, attrs) {\n      var width = element.attr('width') || 200\n      var height = element.attr('height') || 200\n      var apiKey = Config.ExtCredentials.gmaps.api_key\n      var zoom = width > 200 ? 15 : 13\n\n      element.attr('src', 'img/blank.gif')\n\n      var src = 'https://maps.googleapis.com/maps/api/staticmap?sensor=false&center=' + $scope.point['lat'] + ',' + $scope.point['long'] + '&zoom=' + zoom + '&size=' + width + 'x' + height + '&scale=2&markers=color:red|size:big|' + $scope.point['lat'] + ',' + $scope.point['long']\n      var useApiKey = false\n\n      if (useApiKey) {\n        src += '&key=' + apiKey\n      }\n\n      ExternalResourcesManager.downloadByURL(src).then(function (url) {\n        element.attr('src', url.valueOf())\n      })\n    }\n  })\n\n  .directive('myLoadingDots', function ($interval) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.html(isAnimationSupported(element[0])\n        ? '<div class=\"loading_dots\"><i></i><i></i><i></i></div>'\n        : '...'\n      )\n    }\n\n    var animationSupported\n    function isAnimationSupported (el) {\n      if (animationSupported === undefined) {\n        animationSupported = el.style.animationName !== undefined\n        if (animationSupported === false) {\n          var domPrefixes = 'Webkit Moz O ms Khtml'.split(' '), i\n          for (i = 0; i < domPrefixes.length; i++) {\n            if (el.style[domPrefixes[i] + 'AnimationName'] !== undefined) {\n              animationSupported = true\n              break\n            }\n          }\n        }\n      }\n\n      return animationSupported\n    }\n  })\n\n  .directive('myFocused', function (shouldFocusOnInteraction) {\n    return {\n      link: function ($scope, element, attrs) {\n        if (!shouldFocusOnInteraction) {\n          return false\n        }\n        setTimeout(function () {\n          setFieldSelection(element[0])\n        }, 100)\n      }\n    }\n  })\n\n  .directive('myFocusOn', function (shouldFocusOnInteraction) {\n    return {\n      link: function ($scope, element, attrs) {\n        $scope.$on(attrs.myFocusOn, function () {\n          if (!shouldFocusOnInteraction) {\n            return false\n          }\n          onContentLoaded(function () {\n            setFieldSelection(element[0])\n          })\n        })\n      }\n    }\n  })\n\n  .directive('myFileUpload', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.on('change', function () {\n        var self = this\n        $scope.$apply(function () {\n          $scope.photo.file = self.files[0]\n          setTimeout(function () {\n            try {\n              self.value = ''\n            } catch (e) {}\n          }, 1000)\n        })\n      })\n    }\n  })\n\n  .directive('myModalWidth', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      attrs.$observe('myModalWidth', function (newW) {\n        $(element[0].parentNode.parentNode).css({width: parseInt(newW) + (Config.Mobile ? 0 : 32)})\n      })\n    }\n  })\n\n  .directive('myModalNav', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var onKeyDown = function (event) {\n        var target = event.target\n        if (target && (target.tagName == 'INPUT' || target.tagName == 'TEXTAREA')) {\n          return\n        }\n\n        switch (event.keyCode) {\n          case 39: // right\n          case 32: // space\n          case 34: // pg down\n          case 40: // down\n            $scope.$eval(attrs.next)\n            break\n\n          case 37: // left\n          case 33: // pg up\n          case 38: // up\n            $scope.$eval(attrs.prev)\n            break\n        }\n      }\n\n      $(document).on('keydown', onKeyDown)\n\n      $scope.$on('$destroy', function () {\n        $(document).off('keydown', onKeyDown)\n      })\n    }\n  })\n\n  .directive('myCustomBackground', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      $('html').css({background: attrs.myCustomBackground})\n\n      $scope.$on('$destroy', function () {\n        $('html').css({background: ''})\n      })\n    }\n  })\n\n  .directive('myInfiniteScroller', function () {\n    return {\n      link: link,\n      scope: true\n    }\n\n    function link ($scope, element, attrs) {\n      var scrollableWrap = $('.nano-content', element)[0]\n      var moreNotified = false\n\n      $(scrollableWrap).on('scroll', function (e) {\n        if (!element.is(':visible')) return\n        if (!moreNotified &&\n          scrollableWrap.scrollTop >= scrollableWrap.scrollHeight - scrollableWrap.clientHeight - 300) {\n          moreNotified = true\n          $scope.$apply(function () {\n            $scope.slice.limit += ($scope.slice.limitDelta || 20)\n          })\n\n          onContentLoaded(function () {\n            moreNotified = false\n            $(element).nanoScroller()\n          })\n        }\n      })\n    }\n  })\n\n  .directive('myModalPosition', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var updateMargin = function () {\n        if (Config.Mobile &&\n          $(element[0].parentNode.parentNode.parentNode).hasClass('mobile_modal')) {\n          return\n        }\n        var height = element[0].parentNode.offsetHeight\n        var modal = element[0].parentNode.parentNode.parentNode\n        var bottomPanel = $('.media_modal_bottom_panel_wrap', modal)[0]\n        var contHeight = modal.offsetHeight - (bottomPanel && bottomPanel.offsetHeight || 0)\n\n        if (height < contHeight) {\n          $(element[0].parentNode).css('marginTop', (contHeight - height) / 2)\n        } else {\n          $(element[0].parentNode).css('marginTop', '')\n        }\n\n        if (attrs.animation != 'no') {\n          $timeout(function () {\n            $(element[0].parentNode).addClass('modal-content-animated')\n          }, 300)\n        }\n      }\n\n      onContentLoaded(updateMargin)\n\n      $($window).on('resize', updateMargin)\n\n      $scope.$on('ui_height', function (e, sync) {\n        if (sync) {\n          updateMargin()\n        } else {\n          onContentLoaded(updateMargin)\n        }\n      })\n    }\n  })\n\n  .directive('myVerticalPosition', function ($window, $timeout) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var usePadding = attrs.padding === 'true'\n      var prevMargin = 0\n\n      var updateMargin = function () {\n        var height = element[0].offsetHeight\n        var fullHeight = height - (height && usePadding ? 2 * prevMargin : 0)\n        var ratio = attrs.myVerticalPosition && parseFloat(attrs.myVerticalPosition) || 0.5\n        var contHeight = attrs.contHeight ? $scope.$eval(attrs.contHeight) : $($window).height()\n        var margin = fullHeight < contHeight ? parseInt((contHeight - fullHeight) * ratio) : ''\n        var styles = usePadding\n          ? {paddingTop: margin, paddingBottom: margin}\n          : {marginTop: margin, marginBottom: margin}\n\n        element.css(styles)\n        element.addClass('vertical-aligned')\n\n        if (prevMargin !== margin) {\n          $scope.$emit('ui_height')\n        }\n\n        prevMargin = margin\n      }\n\n      $($window).on('resize', updateMargin)\n\n      onContentLoaded(updateMargin)\n\n      $scope.$on('ui_height', function () {\n        onContentLoaded(updateMargin)\n      })\n    }\n  })\n\n  .directive('myUserStatus', function ($filter, $rootScope, AppUsersManager) {\n    var statusFilter = $filter('userStatus')\n    var ind = 0\n    var statuses = {}\n\n    setInterval(updateAll, 90000)\n\n    $rootScope.$on('stateSynchronized', function () {\n      setTimeout(function () {\n        updateAll()\n      }, 100)\n    })\n\n    return {\n      link: link\n    }\n\n    function updateAll () {\n      angular.forEach(statuses, function (update) {\n        update()\n      })\n    }\n\n    function link ($scope, element, attrs) {\n      var userID\n      var curInd = ind++\n      var update = function () {\n        var user = AppUsersManager.getUser(userID)\n        element\n          .html(statusFilter(user, attrs.botChatPrivacy))\n          .toggleClass('status_online', user.status && user.status._ == 'userStatusOnline' || false)\n      // console.log(dT(), 'update status', element[0], user.status && user.status, tsNow(true), element.html())\n      }\n\n      $scope.$watch(attrs.myUserStatus, function (newUserID) {\n        userID = newUserID\n        update()\n      })\n      $scope.$on('user_update', function (e, updUserID) {\n        if (userID == updUserID) {\n          update()\n        }\n      })\n      statuses[curInd] = update\n      $scope.$on('$destroy', function () {\n        delete statuses[curInd]\n      })\n    }\n  })\n\n  .directive('myChatStatus', function ($rootScope, _, MtpApiManager, AppChatsManager, AppUsersManager, AppProfileManager) {\n    var ind = 0\n    var statuses = {}\n\n    var allPluralize = _.pluralize('group_modal_pluralize_participants')\n    var onlinePluralize = _.pluralize('group_modal_pluralize_online_participants')\n\n    var myID = 0\n    MtpApiManager.getUserID().then(function (newMyID) {\n      myID = newMyID\n    })\n\n    setInterval(updateAll, 90000)\n\n    return {\n      link: link\n    }\n\n    function updateAll () {\n      angular.forEach(statuses, function (update) {\n        update()\n      })\n    }\n\n    function link ($scope, element, attrs) {\n      var chatID\n      var curInd = ind++\n      var jump = 0\n      var participantsCount = 0\n      var participants = {}\n\n      var updateParticipants = function () {\n        var curJump = ++jump\n        participantsCount = 0\n        participants = {}\n        if (!chatID) {\n          update()\n          return\n        }\n        AppProfileManager.getChatFull(chatID).then(function (chatFull) {\n          if (curJump != jump) {\n            return\n          }\n          var participantsVector = (chatFull.participants || {}).participants || []\n          participantsCount = participantsVector.length\n          angular.forEach(participantsVector, function (participant) {\n            participants[participant.user_id] = true\n          })\n          if (chatFull.participants_count) {\n            participantsCount = chatFull.participants_count || 0\n          }\n          update()\n        })\n      }\n\n      var update = function () {\n        var html = allPluralize(participantsCount)\n        var onlineCount = 0\n        if (!AppChatsManager.isChannel(chatID)) {\n          var wasMe = false\n          angular.forEach(participants, function (t, userID) {\n            var user = AppUsersManager.getUser(userID)\n            if (user.status && user.status._ == 'userStatusOnline') {\n              if (user.id == myID) {\n                wasMe = true\n              }\n              onlineCount++\n            }\n          })\n          if (onlineCount > 1 || onlineCount == 1 && !wasMe) {\n            html = _('group_modal_participants', {total: html, online: onlinePluralize(onlineCount)})\n          }\n        }\n        if (!onlineCount && !participantsCount) {\n          html = ''\n        }\n        element.html(html)\n      }\n\n      $scope.$watch(attrs.myChatStatus, function (newChatID) {\n        chatID = newChatID\n        updateParticipants()\n      })\n\n      $rootScope.$on('chat_full_update', function (e, updChatID) {\n        if (chatID == updChatID) {\n          updateParticipants()\n        }\n      })\n\n      $rootScope.$on('user_update', function (e, updUserID) {\n        if (participants[updUserID]) {\n          update()\n        }\n      })\n\n      statuses[curInd] = update\n      $scope.$on('$destroy', function () {\n        delete statuses[curInd]\n      })\n    }\n  })\n\n  .directive('myPeerMuted', function ($rootScope, NotificationsManager) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var peerID = $scope.$eval(attrs.myPeerMuted)\n      var className = attrs.mutedClass || 'muted'\n      var unsubscribe = $rootScope.$on('notify_settings', function (e, data) {\n        if (data.peerID == peerID) {\n          updateClass(peerID, element, className)\n        }\n      })\n      updateClass(peerID, element, className)\n\n      $scope.$on('$destroy', unsubscribe)\n    }\n\n    function updateClass (peerID, element, className) {\n      NotificationsManager.getPeerMuted(peerID).then(function (muted) {\n        element.toggleClass(className, muted)\n      })\n    }\n  })\n\n  .directive('myPeerLink', function (AppChatsManager, AppUsersManager) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var override = attrs.userOverride && $scope.$eval(attrs.userOverride) || {}\n      var short = attrs.short && $scope.$eval(attrs.short)\n      var username = attrs.username && $scope.$eval(attrs.username)\n\n      var peerID\n      var update = function () {\n        if (element[0].className.indexOf('user_color_') != -1) {\n          element[0].className = element[0].className.replace(/user_color_\\d+/g, '')\n        }\n        if (peerID > 0) {\n          var user = AppUsersManager.getUser(peerID)\n          var prefix = username ? '@' : ''\n          var key = username ? 'username' : (short ? 'rFirstName' : 'rFullName')\n\n          element.html(\n            prefix +\n            (override[key] || user[key] || '').valueOf() +\n            (attrs.verified && user.pFlags && user.pFlags.verified ? ' <i class=\"icon-verified\"></i>' : '')\n          )\n          if (attrs.color && $scope.$eval(attrs.color)) {\n            element.addClass('user_color_' + user.num)\n          }\n        } else {\n          var chat = AppChatsManager.getChat(-peerID)\n\n          element.html(\n            (chat.rTitle || '').valueOf() +\n            (attrs.verified && chat.pFlags && chat.pFlags.verified ? ' <i class=\"icon-verified\"></i>' : '')\n          )\n        }\n      }\n\n      if (element[0].tagName == 'A' && !hasOnlick(element[0])) {\n        element.on('click', function () {\n          if (peerID > 0) {\n            AppUsersManager.openUser(peerID, override)\n          } else {\n            AppChatsManager.openChat(-peerID)\n          }\n        })\n      }\n\n      if (attrs.peerWatch) { // userWatch, chatWatch\n        $scope.$watch(attrs.myPeerLink, function (newPeerID) {\n          peerID = newPeerID\n          update()\n        })\n      } else {\n        peerID = $scope.$eval(attrs.myPeerLink)\n        update()\n      }\n      if (!attrs.noWatch) {\n        $scope.$on('user_update', function (e, updUserID) {\n          if (peerID == updUserID) {\n            update()\n          }\n        })\n        $scope.$on('chat_update', function (e, updChatID) {\n          if (peerID == -updChatID) {\n            update()\n          }\n        })\n      }\n    }\n  })\n\n  .directive('myPeerPhotolink', function (AppPeersManager, AppUsersManager, AppChatsManager, MtpApiFileManager, FileManager) {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.addClass('peer_photo_init')\n\n      var peerID, peer\n      var peerPhoto\n      var imgEl = $('<img class=\"' + (attrs.imgClass || '') + '\">')\n      var initEl = $('<span class=\"peer_initials nocopy ' + (attrs.imgClass || '') + '\"></span>')\n      var jump = 0\n      var prevClass = false\n\n      var setPeerID = function (newPeerID) {\n        if (peerID == newPeerID) {\n          return false\n        }\n        peerID = newPeerID\n        peer = AppPeersManager.getPeer(peerID)\n\n        var newClass = 'user_bgcolor_' + (peer.num || 1)\n        if (newClass != prevClass) {\n          if (prevClass) {\n            initEl.removeClass(prevClass)\n          }\n          initEl.addClass(newClass)\n          prevClass = newClass\n        }\n\n        updatePeerPhoto()\n\n        return true\n      }\n\n      var updatePeerPhoto = function () {\n        var curJump = ++jump\n\n        peerPhoto = peer.photo && angular.copy(peer.photo.photo_small)\n\n        var hasPhoto = peerPhoto !== undefined\n\n        if (hasPhoto) {\n          var cachedBlob = MtpApiFileManager.getCachedFile(peer.photo.photo_small)\n          if (cachedBlob) {\n            initEl.remove()\n            imgEl.prependTo(element).attr('src', FileManager.getUrl(cachedBlob, 'image/jpeg'))\n            return\n          }\n        }\n\n        initEl.attr('data-content', peer.initials || '').prependTo(element)\n        imgEl.remove()\n\n        if (hasPhoto) {\n          MtpApiFileManager.downloadSmallFile(peer.photo.photo_small).then(function (blob) {\n            if (curJump != jump) {\n              return\n            }\n            initEl.remove()\n            imgEl.prependTo(element).attr('src', FileManager.getUrl(blob, 'image/jpeg'))\n          }, function (e) {\n            console.log('Download image failed', e, peer.photo.photo_small, element[0])\n          })\n        }\n      }\n\n      if (element[0].tagName == 'A' && !attrs.noOpen) {\n        element.on('click', function (e) {\n          if (peerID > 0) {\n            AppUsersManager.openUser(peerID, attrs.userOverride && $scope.$eval(attrs.userOverride))\n          } else {\n            AppChatsManager.openChat(-peerID)\n          }\n        })\n      }\n\n      $scope.$watch(attrs.myPeerPhotolink, setPeerID)\n      setPeerID($scope.$eval(attrs.myPeerPhotolink))\n\n      if (attrs.watch) {\n        $scope.$on('user_update', function (e, updUserID) {\n          if (peerID == updUserID) {\n            if (!angular.equals(peer.photo && peer.photo.photo_small, peerPhoto)) {\n              updatePeerPhoto()\n            }\n          }\n        })\n        $scope.$on('chat_update', function (e, updChatID) {\n          if (peerID == -updChatID) {\n            if (!angular.equals(peer.photo && peer.photo.photo_small, peerPhoto)) {\n              updatePeerPhoto()\n            }\n          }\n        })\n      }\n    }\n  })\n\n  .directive('myAudioPlayer', function ($timeout, $q, Storage, AppDocsManager, AppMessagesManager, ErrorService) {\n    var currentPlayer = false\n    var audioVolume = 0.5\n\n    Storage.get('audio_volume').then(function (newAudioVolume) {\n      if (newAudioVolume > 0 && newAudioVolume <= 1.0) {\n        audioVolume = newAudioVolume\n      }\n    })\n\n    var onAudioError = function (event) {\n      if (!event.target ||\n        !event.target.error ||\n        event.target.error.code == event.target.error.MEDIA_ERR_DECODE ||\n        event.target.error.code == event.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n        ErrorService.show({\n          error: {\n            type: 'MEDIA_TYPE_NOT_SUPPORTED',\n            originalError: event.target && event.target.error\n          }\n        })\n      }\n    }\n\n    return {\n      link: link,\n      scope: {\n        audio: '=',\n        message: '='\n      },\n      templateUrl: templateUrl('audio_player')\n    }\n\n    function checkPlayer (newPlayer) {\n      if (newPlayer === currentPlayer) {\n        return false\n      }\n      if (currentPlayer) {\n        currentPlayer.pause()\n      }\n      currentPlayer = newPlayer\n    }\n\n    function link ($scope, element, attrs) {\n      AppDocsManager.updateDocDownloaded($scope.audio.id)\n\n      $scope.volume = audioVolume\n      $scope.mediaPlayer = {}\n\n      $scope.download = function () {\n        AppDocsManager.saveDocFile($scope.audio.id)\n      }\n\n      $scope.togglePlay = function () {\n        if ($scope.audio.url) {\n          checkPlayer($scope.mediaPlayer.player)\n          $scope.mediaPlayer.player.playPause()\n        }\n        else if ($scope.audio.progress && $scope.audio.progress.enabled) {\n          return\n        }else {\n          AppDocsManager.downloadDoc($scope.audio.id).then(function () {\n            onContentLoaded(function () {\n              var errorListenerEl = $('audio', element)[0] || element[0]\n              if (errorListenerEl) {\n                var errorAlready = false\n                var onAudioError = function (event) {\n                  if (errorAlready) {\n                    return\n                  }\n                  if (!event.target ||\n                    !event.target.error ||\n                    event.target.error.code == event.target.error.MEDIA_ERR_DECODE ||\n                    event.target.error.code == event.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED) {\n                    errorAlready = true\n                    ErrorService.show({\n                      error: {\n                        type: 'MEDIA_TYPE_NOT_SUPPORTED',\n                        originalError: event.target && event.target.error\n                      }\n                    })\n                  }\n                }\n\n                errorListenerEl.addEventListener('error', onAudioError, true)\n                $scope.$on('$destroy', function () {\n                  errorAlready = true\n                  errorListenerEl.removeEventListener('error', onAudioError)\n                })\n              }\n              setTimeout(function () {\n                checkPlayer($scope.mediaPlayer.player)\n                $scope.mediaPlayer.player.setVolume(audioVolume)\n                $scope.mediaPlayer.player.play()\n\n                if ($scope.message &&\n                  !$scope.message.pFlags.out &&\n                  $scope.message.pFlags.media_unread) {\n                  AppMessagesManager.readMessages([$scope.message.mid])\n                }\n              }, 300)\n            })\n          })\n        }\n      }\n\n      $scope.seek = function (position) {\n        if ($scope.mediaPlayer && $scope.mediaPlayer.player) {\n          $scope.mediaPlayer.player.seek(position)\n        } else {\n          $scope.togglePlay()\n        }\n      }\n      $scope.setVolume = function (volume) {\n        audioVolume = volume\n        Storage.set({audio_volume: volume})\n        if ($scope.mediaPlayer && $scope.mediaPlayer.player) {\n          $scope.mediaPlayer.player.setVolume(volume)\n        }\n      }\n    }\n  })\n\n  .directive('mySlider', function ($window) {\n    return {\n      link: link,\n      templateUrl: templateUrl('slider')\n    }\n\n    function link ($scope, element, attrs) {\n      var wrap = $('.tg_slider_wrap', element)\n      var fill = $('.tg_slider_track_fill', element)\n      var thumb = $('.tg_slider_thumb', element)\n      var width = wrap.width()\n      var thumbWidth = Math.ceil(thumb.width())\n      var model = attrs.sliderModel\n      var sliderCallback = attrs.sliderOnchange\n      var minValue = 0.0\n      var maxValue = 1.0\n      var lastUpdValue = false\n      var lastMinPageX = false\n\n      if (attrs.sliderMin) {\n        $scope.$watch(attrs.sliderMin, function (newMinValue) {\n          minValue = newMinValue || 0.0\n        })\n      }\n      if (attrs.sliderMax) {\n        $scope.$watch(attrs.sliderMax, function (newMaxValue) {\n          maxValue = newMaxValue || 1.0\n        })\n      }\n\n      var onSliderMove = function (e) {\n        e = e.originalEvent || e\n\n        var offsetX = (e.touches && e.touches[0] ? e.touches[0].pageX : e.pageX) - lastMinPageX\n        offsetX = Math.min(width, Math.max(0 , offsetX))\n        // console.log(e.type, lastMinPageX, e.pageX, offsetX)\n        lastUpdValue = minValue + offsetX / width * (maxValue - minValue)\n        if (sliderCallback) {\n          $scope.$eval(sliderCallback, {value: lastUpdValue})\n        } else {\n          $scope.$eval(model + '=' + lastUpdValue)\n        }\n\n        thumb.css('left', Math.max(0, offsetX - thumbWidth))\n        fill.css('width', offsetX)\n\n        return cancelEvent(e)\n      }\n      var stopSliderTrack = function () {\n        $($window).off('mousemove touchmove', onSliderMove)\n        $($window).off('mouseup touchend touchcancel touchleave', stopSliderTrack)\n      }\n\n      $scope.$watch(model, function (newVal) {\n        if (newVal != lastUpdValue && newVal !== undefined) {\n          var percent = Math.max(0, (newVal - minValue) / (maxValue - minValue))\n          if (width) {\n            var offsetX = Math.ceil(width * percent)\n            offsetX = Math.min(width, Math.max(0 , offsetX))\n            thumb.css('left', Math.max(0, offsetX - thumbWidth))\n            fill.css('width', offsetX)\n          } else {\n            thumb.css('left', percent * 100 + '%')\n            fill.css('width', percent * 100 + '%')\n          }\n          lastUpdValue = false\n        }\n      })\n\n      element.on('dragstart selectstart', cancelEvent)\n\n      element.on('mousedown touchstart', function (e) {\n        if (!width) {\n          width = wrap.width()\n          if (!width) {\n            console.error('empty width')\n            return cancelEvent(e)\n          }\n        }\n        stopSliderTrack()\n\n        e = e.originalEvent || e\n\n        var offsetX\n        if (e.touches && e.touches[0]) {\n          lastMinPageX = element.position().left\n          offsetX = e.touches[0].pageX - lastMinPageX\n        }\n        else if (e.offsetX !== undefined) {\n          offsetX = e.offsetX\n          lastMinPageX = e.pageX - offsetX\n        }\n        else if (e.layerX !== undefined) {\n          offsetX = e.layerX\n          lastMinPageX = e.pageX - offsetX\n        }else {\n          return cancelEvent(e)\n        }\n\n        // console.log(e.type, e, lastMinPageX, e.pageX, offsetX)\n        lastUpdValue = minValue + offsetX / width * (maxValue - minValue)\n        if (sliderCallback) {\n          $scope.$eval(sliderCallback, {value: lastUpdValue})\n        } else {\n          $scope.$eval(model + '=' + lastUpdValue)\n        }\n\n        thumb.css('left', Math.max(0, offsetX - thumbWidth))\n        fill.css('width', offsetX)\n\n        $($window).on('mousemove touchmove', onSliderMove)\n        $($window).on('mouseup touchend touchcancel touchleave', stopSliderTrack)\n\n        return cancelEvent(e)\n      })\n    }\n  })\n\n  .directive('myLabeledInput', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      var input = $('.md-input:first', element)\n      var label = $('.md-input-label:first', element)\n      var isDisabled = input[0] && input[0].tagName == 'SPAN'\n      var focused = false\n      var updateHasValueClass = function () {\n        if (isDisabled) {\n          element.toggleClass('md-input-has-value', input.html().length > 0)\n        } else {\n          element.toggleClass('md-input-has-value', focused || input.val().length > 0)\n        }\n      }\n\n      updateHasValueClass()\n      onContentLoaded(function () {\n        updateHasValueClass()\n        setZeroTimeout(function () {\n          element.addClass('md-input-animated')\n        })\n      })\n\n      if (!isDisabled) {\n        input.on('blur focus change', function (e) {\n          focused = e.type == 'focus'\n          element.toggleClass('md-input-focused', focused)\n          updateHasValueClass()\n        })\n      }\n\n      $scope.$on('value_updated', function () {\n        setZeroTimeout(function () {\n          updateHasValueClass()\n        })\n      })\n    }\n  })\n\n  .directive('myCopyField', function (toaster, _) {\n    return {\n      scope: {\n        selectEvent: '=myCopyField'\n      },\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.attr('readonly', 'true')\n      element[0].readonly = true\n      element.on('click', function () {\n        this.select()\n      })\n\n      if ($scope.selectEvent) {\n        $scope.$on($scope.selectEvent, function () {\n          setTimeout(function () {\n            element[0].focus()\n            element[0].select()\n          }, 100)\n        })\n      }\n    }\n  })\n\n  .directive('myCopyLink', function ($compile, $timeout, _) {\n    return {\n      restrict: 'A',\n      replace: false,\n      terminal: true,\n      priority: 1000,\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.attr('tooltip', '{{ttLabel}}')\n      element.removeAttr('my-copy-link')\n      element.removeAttr('data-my-copy-link')\n\n      var resetPromise = false\n      var resetTooltip = function () {\n        $timeout.cancel(resetPromise)\n        resetPromise = false\n        $scope.ttLabel = _('conversations_modal_share_url_copy_raw')\n      }\n\n      resetTooltip()\n\n      $compile(element)($scope)\n\n      var clipboard = new Clipboard(element[0])\n\n      clipboard.on('success', function (e) {\n        $timeout.cancel(resetPromise)\n        $scope.$apply(function () {\n          $scope.ttLabel = _('clipboard_copied_raw')\n        })\n        resetPromise = $timeout(resetTooltip, 2000)\n      })\n\n      clipboard.on('error', function (e) {\n        $timeout.cancel(resetPromise)\n        var langKey = Config.Navigator.osX\n          ? 'clipboard_press_cmd_c'\n          : 'clipboard_press_ctrl_c'\n        $scope.$apply(function () {\n          $scope.ttLabel = _(langKey + '_raw')\n        })\n        resetPromise = $timeout(resetTooltip, 5000)\n      })\n\n      $scope.$on('$destroy', function () {\n        clipboard.destroy()\n      })\n    }\n  })\n\n  .directive('mySubmitOnEnter', function () {\n    return {\n      link: link\n    }\n\n    function link ($scope, element, attrs) {\n      element.on('keydown', function (event) {\n        if (event.keyCode == 13) {\n          element.trigger('submit')\n          return cancelEvent(event)\n        }\n      })\n    }\n  })\n\n  .directive('myArcProgress', function () {\n    var html =\n    '<svg class=\"progress-arc\" viewPort=\"0 0 100 100\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\\\n  <defs>\\\n    <linearGradient id=\"grad_intermediate%id%\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\\\n      <stop offset=\"0%\" class=\"stop0\" />\\\n      <stop offset=\"60%\" class=\"stop60\" />\\\n      <stop offset=\"100%\"  class=\"stop100\"/>\\\n    </linearGradient>\\\n  </defs>\\\n  <circle class=\"progress-arc-bar\"></circle>\\\n</svg>'\n\n    function updateProgress (bar, progress, fullLen) {\n      progress = Math.max(0.0, Math.min(progress, 1.0))\n      var minProgress = 0.2\n      progress = minProgress + (1 - minProgress) * progress\n      bar.css({strokeDasharray: (progress * fullLen) + ', ' + ((1 - progress) * fullLen)})\n    }\n\n    var num = 0\n\n    return {\n      scope: {\n        progress: '=myArcProgress'\n      },\n      link: function ($scope, element, attrs) {\n        var intermediate = !attrs.myArcProgress\n        var width = attrs.width || element.width() || 40\n        var stroke = attrs.stroke || (width / 2 * 0.14)\n        var center = width / 2\n        var radius = center - (stroke / 2)\n\n        // Doesn't work without unique id for every gradient\n        var curNum = ++num\n\n        element\n          .html(html.replace('%id%', curNum))\n          .addClass('progress-arc-wrap')\n          .addClass(intermediate ? 'progress-arc-intermediate' : 'progress-arc-percent')\n          .css({width: width, height: width})\n\n        $(element[0].firstChild)\n          .attr('width', width)\n          .attr('height', width)\n\n        var bar = $('.progress-arc-bar', element)\n        bar\n          .attr('cx', center)\n          .attr('cy', center)\n          .attr('r', radius)\n          .css({strokeWidth: stroke})\n\n        var fullLen = 2 * Math.PI * radius\n        if (intermediate) {\n          updateProgress(bar, 0.3, fullLen)\n          bar.css({stroke: 'url(#grad_intermediate' + curNum + ')'})\n        } else {\n          $scope.$watch('progress', function (newProgress) {\n            updateProgress(bar, newProgress / 100.0, fullLen)\n          })\n        }\n      }\n    }\n  })\n\n  .directive('myScrollToOn', function () {\n    return {\n      link: function ($scope, element, attrs) {\n        var ev = attrs.myScrollToOn\n        var doScroll = function () {\n          onContentLoaded(function () {\n            $('html, body').animate({\n              scrollTop: element.offset().top\n            }, 200)\n          })\n        }\n        if (ev == '$init') {\n          doScroll()\n        } else {\n          $scope.$on(ev, doScroll)\n        }\n      }\n    }\n  })\n\n  .directive('myComposerDropdown', function () {\n    return {\n      templateUrl: templateUrl('composer_dropdown')\n    }\n  })\n\n  .directive('myEmojiSuggestions', function () {\n    return {\n      link: function ($scope, element, attrs) {\n        $scope.$watchCollection('emojiCodes', function (codes) {\n          // var codes = $scope.$eval(attrs.myEmojiSuggestions)\n          var html = []\n          var iconSize = Config.Mobile ? 26 : 20\n\n          var emoticonCode, emoticonData\n          var spritesheet, pos\n          var categoryIndex\n          var count = Math.min(5, codes.length)\n          var i, x\n          var y\n\n          for (i = 0; i < count; i++) {\n            emoticonCode = codes[i]\n            if (emoticonCode.code) {\n              emoticonCode = emoticonCode.code\n            }\n            if (emoticonData = Config.Emoji[emoticonCode]) {\n              spritesheet = EmojiHelper.spritesheetPositions[emoticonCode]\n              categoryIndex = spritesheet[0]\n              pos = spritesheet[1]\n              x = iconSize * spritesheet[3]\n              y = iconSize * spritesheet[2]\n              html.push('<li><a class=\"composer_emoji_option\" data-code=\"' + encodeEntities(emoticonCode) + '\"><i class=\"emoji emoji-w', iconSize, ' emoji-spritesheet-' + categoryIndex + '\" style=\"background-position: -' + x + 'px -' + y + 'px;\"></i><span class=\"composer_emoji_shortcut\">:' + encodeEntities(emoticonData[1][0]) + ':</span></a></li>')\n            }\n          }\n          // onContentLoaded(function () {\n          element.html(html.join(''))\n          console.log(dT(), 'emoji done')\n        // })\n        })\n      }\n    }\n  })\n\n  .directive('myInlineResults', function (AppPhotosManager, ExternalResourcesManager, AppDocsManager) {\n    return {\n      templateUrl: templateUrl('inline_results'),\n      scope: {\n        botResults: '=myInlineResults'\n      },\n\n      link: function ($scope, element, attrs) {\n        $scope.$watch('botResults.results', function (results) {\n          angular.forEach(results, function (result) {\n            if (result.thumb_url && !result.thumbUrl) {\n              ExternalResourcesManager.downloadByURL(result.thumb_url).then(function (url) {\n                result.thumbUrl = url\n              })\n            }\n            if (result.type == 'gif' && result.content_url && !result.contentUrl) {\n              ExternalResourcesManager.downloadByURL(result.content_url).then(function (url) {\n                result.contentUrl = url\n              })\n            }\n            if ((result.type == 'gif' || result.type == 'sticker') && result.document) {\n              AppDocsManager.downloadDoc(result.document.id)\n            }\n            if (result.type == 'photo' && result.photo) {\n              var photoSize = AppPhotosManager.choosePhotoSize(result.photo, result.thumbW, result.thumbH)\n              var dim = calcImageInBox(photoSize.w, photoSize.h, result.thumbW, result.thumbH)\n              result.thumb = {\n                width: dim.w,\n                height: dim.h,\n                location: photoSize.location,\n                size: photoSize.size\n              }\n            }\n            if (result.type == 'game' && result.photo) {\n              var photoSize = AppPhotosManager.choosePhotoSize(result.photo, 100, 100)\n              // var dim = calcImageInBox(photoSize.w, photoSize.h, result.thumbW, result.thumbH)\n              result.thumb = {\n                // width: dim.w,\n                // height: dim.h,\n                location: photoSize.location,\n                size: photoSize.size\n              }\n            }\n          })\n        })\n      }\n    }\n  })\n\n  .directive('myGameCommunication', function ($window) {\n    function link ($scope, element, attrs) {\n      onContentLoaded(function () {\n        var iframe = $('iframe, webview', element)[0]\n        var contentWindow = iframe.contentWindow\n        var handler = function (event) {\n          event = event.originalEvent || event\n          if (event.source && event.source != contentWindow) {\n            return\n          }\n          var data = event.data\n          try {\n            var dataParsed = JSON.parse(data)\n          } catch (e) {\n            return\n          }\n          if (!dataParsed || !dataParsed.eventType) {\n            return\n          }\n          $scope.$emit('game_frame_event', dataParsed);\n        }\n\n        $($window).on('message', handler)\n\n        $scope.$on('$destroy', function () {\n          $($window).off('message', handler)\n        })\n      })\n    }\n\n    return {\n      link: link\n    }\n  })\n\n  .directive('myEmojiImage', function (RichTextProcessor) {\n\n    function link ($scope, element, attrs) {\n      var emoji = attrs.myEmojiImage\n      var html = RichTextProcessor.wrapRichText(emoji, {noLinks: true, noLinebreaks: true})\n      element.html(html.valueOf())\n    }\n\n    return {\n      link: link\n    }\n  })\n\n  .directive('myExternalEmbed', function () {\n    var twitterAttached = false\n    var facebookAttached = false\n    var gplusAttached = false\n    var twitterPendingWidgets = []\n    var facebookPendingWidgets = []\n    var embedTag = Config.Modes.chrome_packed ? 'webview' : 'iframe'\n\n    function link ($scope, element, attrs) {\n      var embedData = $scope.$eval(attrs.myExternalEmbed)\n      if (!embedData) {\n        return\n      }\n      var html = ''\n      var callback = false\n      var needTwitter = false\n      switch (embedData[0]) {\n        case 'youtube':\n          var videoID = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_video_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" ' +\n            'src=\"https://www.youtube.com/embed/' + videoID +\n            '?autoplay=0&amp;controls=2\" webkitallowfullscreen mozallowfullscreen allowfullscreen></' + embedTag + '></div>'\n          break\n\n        case 'vimeo':\n          var videoID = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_video_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" ' +\n            'src=\"https://player.vimeo.com/video/' + videoID +\n            '?title=0&amp;byline=0&amp;portrait=0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></' + embedTag + '></div>'\n          break\n\n        case 'instagram':\n          var instaID = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_insta_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" ' +\n            'src=\"https://instagram.com/p/' + instaID +\n            '/embed/\"></' + embedTag + '></div>'\n          break\n\n        case 'vine':\n          var vineID = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_vine_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" ' +\n            'src=\"https://vine.co/v/' + vineID + '/embed/simple\"></' + embedTag + '></div>'\n          break\n\n        case 'soundcloud':\n          var soundcloudUrl = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_soundcloud_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" ' +\n            'src=\"https://w.soundcloud.com/player/?url=' + encodeEntities(encodeURIComponent(soundcloudUrl)) +\n            '&amp;auto_play=false&amp;hide_related=true&amp;show_comments=false&amp;show_user=true&amp;show_reposts=false&amp;visual=true\"></' + embedTag + '></div>'\n          break\n\n        case 'spotify':\n          var spotifyUrl = embedData[1]\n          html = '<div class=\"im_message_media_embed im_message_spotify_embed\"><' + embedTag + ' type=\"text/html\" frameborder=\"0\" allowtransparency=\"true\" ' +\n            'src=\"https://embed.spotify.com/?uri=spotify:' + encodeEntities(encodeURIComponent(spotifyUrl)) +\n            '\"></' + embedTag + '></div>'\n          break\n\n        case 'twitter':\n          html = '<div class=\"im_message_twitter_embed\"><blockquote class=\"twitter-tweet\" lang=\"en\"><a href=\"' + embedData[1] + '\"></a></blockquote></div>'\n\n          callback = function () {\n            if (!twitterAttached) {\n              twitterAttached = true\n              $('<script>')\n                .appendTo('body')\n                .on('load', function () {\n                  twttr.events.bind('loaded', function (event) {\n                    for (var i = 0; i < twitterPendingWidgets.length; i++) {\n                      twitterPendingWidgets[i].$emit('ui_height')\n                    }\n                    twitterPendingWidgets = []\n                  })\n                })\n                .attr('src', 'https://platform.twitter.com/widgets.js')\n            }\n            else if (window.twttr) {\n              twttr.widgets.load(element[0])\n            }\n            twitterPendingWidgets.push($scope)\n          }\n          break\n\n        case 'facebook':\n          html = '<div class=\"im_message_facebook_embed\"><div class=\"fb-post\" data-href=\"' + embedData[1] + '\" data-width=\"300\"></div></div>'\n\n          callback = function () {\n            if (!facebookAttached) {\n              facebookAttached = true\n              $('<script>')\n                .appendTo('body')\n                .on('load', function () {\n                  FB.Event.subscribe('xfbml.render', function (event) {\n                    for (var i = 0; i < facebookPendingWidgets.length; i++) {\n                      facebookPendingWidgets[i].$emit('ui_height')\n                    }\n                    facebookPendingWidgets = []\n                  })\n                })\n                .attr('src', 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&appId=254098051407226&version=v2.0')\n            }\n\n            else if (window.FB) {\n              FB.XFBML.parse(element[0])\n            }\n            facebookPendingWidgets.push($scope)\n          }\n          break\n\n        case 'gplus':\n          html = '<div class=\"im_message_gplus_embed\"><div class=\"g-post\" data-href=\"' + embedData[1] + '\"></div></div>'\n\n          callback = function () {\n            if (!gplusAttached) {\n              gplusAttached = true\n\n              window.___gcfg = {'parsetags': 'explicit'}\n              $('<script>')\n                .appendTo('body')\n                .on('load', function () {\n                  gapi.post.go()\n                })\n                .attr('src', 'https://apis.google.com/js/plusone.js')\n            }\n            else if (window.gapi) {\n              gapi.post.go(element[0])\n            }\n            element.one('load', function () {\n              $scope.$emit('ui_height')\n            })\n          }\n          break\n      }\n\n      if (html) {\n        element[0].innerHTML = html\n        if (callback) {\n          callback()\n        }\n      }\n    }\n\n    return {\n      link: link\n    }\n  })\n"]}