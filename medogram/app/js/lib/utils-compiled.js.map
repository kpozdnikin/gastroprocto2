{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["/*!\n * Webogram v0.5.5 - messaging web application for MTProto\n * https://github.com/zhukov/webogram\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\n * https://github.com/zhukov/webogram/blob/master/LICENSE\n */\n\nvar _logTimer = (new Date()).getTime()\nfunction dT () {\n  return '[' + (((new Date()).getTime() - _logTimer) / 1000).toFixed(3) + ']'\n}\n\nfunction checkClick (e, noprevent) {\n  if (e.which == 1 && (e.ctrlKey || e.metaKey) || e.which == 2) {\n    return true\n  }\n\n  if (!noprevent) {\n    e.preventDefault()\n  }\n\n  return false\n}\n\nfunction isInDOM (element, parentNode) {\n  if (!element) {\n    return false\n  }\n  parentNode = parentNode || document.body\n  if (element == parentNode) {\n    return true\n  }\n  return isInDOM(element.parentNode, parentNode)\n}\n\nfunction checkDragEvent (e) {\n  if (!e || e.target && (e.target.tagName == 'IMG' || e.target.tagName == 'A')) return false\n  if (e.dataTransfer && e.dataTransfer.types) {\n    for (var i = 0; i < e.dataTransfer.types.length; i++) {\n      if (e.dataTransfer.types[i] == 'Files') {\n        return true\n      }\n    }\n  } else {\n    return true\n  }\n\n  return false\n}\n\nfunction cancelEvent (event) {\n  event = event || window.event\n  if (event) {\n    event = event.originalEvent || event\n\n    if (event.stopPropagation) event.stopPropagation()\n    if (event.preventDefault) event.preventDefault()\n    event.returnValue = false\n    event.cancelBubble = true\n  }\n\n  return false\n}\n\nfunction hasOnlick (element) {\n  if (element.onclick ||\n    element.getAttribute('ng-click')) {\n    return true\n  }\n  var events = $._data(element, 'events')\n  if (events && (events.click || events.mousedown)) {\n    return true\n  }\n  return false\n}\n\nfunction getScrollWidth () {\n  var outer = $('<div>').css({\n    position: 'absolute',\n    width: 100,\n    height: 100,\n    overflow: 'scroll',\n    top: -9999\n  }).appendTo($(document.body))\n\n  var scrollbarWidth = outer[0].offsetWidth - outer[0].clientWidth\n  outer.remove()\n\n  return scrollbarWidth\n}\n\nfunction onCtrlEnter (textarea, cb) {\n  $(textarea).on('keydown', function (e) {\n    if (e.keyCode == 13 && (e.ctrlKey || e.metaKey)) {\n      cb()\n      return cancelEvent(e)\n    }\n  })\n}\n\nfunction setFieldSelection (field, from, to) {\n  field = $(field)[0]\n  try {\n    field.focus()\n    if (from === undefined || from === false) {\n      from = field.value.length\n    }\n    if (to === undefined || to === false) {\n      to = from\n    }\n    if (field.createTextRange) {\n      var range = field.createTextRange()\n      range.collapse(true)\n      range.moveEnd('character', to)\n      range.moveStart('character', from)\n      range.select()\n    }\n    else if (field.setSelectionRange) {\n      field.setSelectionRange(from, to)\n    }\n  } catch(e) {}\n}\n\nfunction getFieldSelection (field) {\n  if (field.selectionStart) {\n    return field.selectionStart\n  }\n  else if (!document.selection) {\n    return 0\n  }\n\n  var c = '\\x01'\n  var sel = document.selection.createRange()\n  var txt = sel.text\n  var dup = sel.duplicate()\n  var len = 0\n\n  try {\n    dup.moveToElementText(field)\n  } catch(e) {\n    return 0\n  }\n\n  sel.text = txt + c\n  len = dup.text.indexOf(c)\n  sel.moveStart('character', -1)\n  sel.text = ''\n\n  // if (browser.msie && len == -1) {\n  //   return field.value.length\n  // }\n  return len\n}\n\nfunction getRichValue (field) {\n  if (!field) {\n    return ''\n  }\n  var lines = []\n  var line = []\n\n  getRichElementValue(field, lines, line)\n  if (line.length) {\n    lines.push(line.join(''))\n  }\n\n  var value = lines.join('\\n')\n  value = value.replace(/\\u00A0/g, ' ')\n\n  return value\n}\n\nfunction getRichValueWithCaret (field) {\n  if (!field) {\n    return []\n  }\n  var lines = []\n  var line = []\n\n  var sel = window.getSelection ? window.getSelection() : false\n  var selNode\n  var selOffset\n  if (sel && sel.rangeCount) {\n    var range = sel.getRangeAt(0)\n    if (range.startContainer &&\n      range.startContainer == range.endContainer &&\n      range.startOffset == range.endOffset) {\n      selNode = range.startContainer\n      selOffset = range.startOffset\n    }\n  }\n\n  getRichElementValue(field, lines, line, selNode, selOffset)\n\n  if (line.length) {\n    lines.push(line.join(''))\n  }\n\n  var value = lines.join('\\n')\n  var caretPos = value.indexOf('\\x01')\n  if (caretPos != -1) {\n    value = value.substr(0, caretPos) + value.substr(caretPos + 1)\n  }\n  value = value.replace(/\\u00A0/g, ' ')\n\n  return [value, caretPos]\n}\n\nfunction getRichElementValue (node, lines, line, selNode, selOffset) {\n  if (node.nodeType == 3) { // TEXT\n    if (selNode === node) {\n      var value = node.nodeValue\n      line.push(value.substr(0, selOffset) + '\\x01' + value.substr(selOffset))\n    } else {\n      line.push(node.nodeValue)\n    }\n    return\n  }\n  if (node.nodeType != 1) { // NON-ELEMENT\n    return\n  }\n  var isSelected = (selNode === node)\n  var isBlock = node.tagName == 'DIV' || node.tagName == 'P'\n  var curChild\n  if (isBlock && line.length || node.tagName == 'BR') {\n    lines.push(line.join(''))\n    line.splice(0, line.length)\n  }\n  else if (node.tagName == 'IMG') {\n    if (node.alt) {\n      line.push(node.alt)\n    }\n  }\n  if (isSelected && !selOffset) {\n    line.push('\\x01')\n  }\n  var curChild = node.firstChild\n  while (curChild) {\n    getRichElementValue(curChild, lines, line, selNode, selOffset)\n    curChild = curChild.nextSibling\n  }\n  if (isSelected && selOffset) {\n    line.push('\\x01')\n  }\n  if (isBlock && line.length) {\n    lines.push(line.join(''))\n    line.splice(0, line.length)\n  }\n}\n\nfunction setRichFocus (field, selectNode, noCollapse) {\n  field.focus()\n  if (selectNode &&\n    selectNode.parentNode == field &&\n    !selectNode.nextSibling &&\n    !noCollapse) {\n    field.removeChild(selectNode)\n    selectNode = null\n  }\n  if (window.getSelection && document.createRange) {\n    var range = document.createRange()\n    if (selectNode) {\n      range.selectNode(selectNode)\n    } else {\n      range.selectNodeContents(field)\n    }\n    if (!noCollapse) {\n      range.collapse(false)\n    }\n\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n    sel.addRange(range)\n  }\n  else if (document.body.createTextRange !== undefined) {\n    var textRange = document.body.createTextRange()\n    textRange.moveToElementText(selectNode || field)\n    if (!noCollapse) {\n      textRange.collapse(false)\n    }\n    textRange.select()\n  }\n}\n\nfunction getSelectedText () {\n  var sel = (\n  window.getSelection && window.getSelection() ||\n  document.getSelection && document.getSelection() ||\n  document.selection && document.selection.createRange().text || ''\n    ).toString().replace(/^\\s+|\\s+$/g, '')\n\n  return sel\n}\n\nfunction scrollToNode (scrollable, node, scroller) {\n  var elTop = node.offsetTop - 15\n  var elHeight = node.offsetHeight + 30\n  var scrollTop = scrollable.scrollTop\n  var viewportHeight = scrollable.clientHeight\n\n  if (scrollTop > elTop) { // we are below the node to scroll\n    scrollable.scrollTop = elTop\n    $(scroller).nanoScroller({flash: true})\n  }\n  else if (scrollTop < elTop + elHeight - viewportHeight) { // we are over the node to scroll\n    scrollable.scrollTop = elTop + elHeight - viewportHeight\n    $(scroller).nanoScroller({flash: true})\n  }\n}\n\nif (Config.Modes.animations &&\n  typeof window.requestAnimationFrame == 'function') {\n  window.onAnimationFrameCallback = function (cb) {\n    return (function () {\n      window.requestAnimationFrame(cb)\n    })\n  }\n} else {\n  window.onAnimationFrameCallback = function (cb) {\n    return cb\n  }\n}\n\nfunction onContentLoaded (cb) {\n  cb = onAnimationFrameCallback(cb)\n  setZeroTimeout(cb)\n}\n\nfunction tsNow (seconds) {\n  var t = +new Date() + (window.tsOffset || 0)\n  return seconds ? Math.floor(t / 1000) : t\n}\n\nfunction safeReplaceObject (wasObject, newObject) {\n  for (var key in wasObject) {\n    if (!newObject.hasOwnProperty(key) && key.charAt(0) != '$') {\n      delete wasObject[key]\n    }\n  }\n  for (var key in newObject) {\n    if (newObject.hasOwnProperty(key)) {\n      wasObject[key] = newObject[key]\n    }\n  }\n}\n\nfunction listMergeSorted (list1, list2) {\n  list1 = list1 || []\n  list2 = list2 || []\n\n  var result = angular.copy(list1)\n\n  var minID = list1.length ? list1[list1.length - 1] : 0xFFFFFFFF\n  for (var i = 0; i < list2.length; i++) {\n    if (list2[i] < minID) {\n      result.push(list2[i])\n    }\n  }\n\n  return result\n}\n\nfunction listUniqSorted (list) {\n  list = list || []\n  var resultList = []\n  var prev = false\n  for (var i = 0; i < list.length; i++) {\n    if (list[i] !== prev) {\n      resultList.push(list[i])\n    }\n    prev = list[i]\n  }\n\n  return resultList\n}\n\nfunction templateUrl (tplName) {\n  var forceLayout = {\n    confirm_modal: 'desktop',\n    error_modal: 'desktop',\n    media_modal_layout: 'desktop',\n    slider: 'desktop',\n    reply_message: 'desktop',\n    message_body: 'desktop',\n    message_media: 'desktop',\n    message_attach_game: 'desktop',\n    forwarded_messages: 'desktop',\n    chat_invite_link_modal: 'desktop',\n    reply_markup: 'desktop',\n    short_message: 'desktop',\n    pinned_message: 'desktop',\n    channel_edit_modal: 'desktop',\n    megagroup_edit_modal: 'desktop',\n    inline_results: 'desktop',\n    composer_dropdown: 'desktop'\n  }\n  var layout = forceLayout[tplName] || (Config.Mobile ? 'mobile' : 'desktop')\n  return 'partials/' + layout + '/' + tplName + '.html'\n}\n\nfunction encodeEntities (value) {\n  return value.replace(/&/g, '&amp;').replace(/[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g, function (value) {\n    var hi = value.charCodeAt(0)\n    var low = value.charCodeAt(1)\n    return '&#' + (((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000) + ';'\n  }).replace(/([^\\#-~| |!])/g, function (value) { // non-alphanumeric\n    return '&#' + value.charCodeAt(0) + ';'\n  }).replace(/</g, '&lt;').replace(/>/g, '&gt;')\n}\n\nfunction calcImageInBox (imageW, imageH, boxW, boxH, noZooom) {\n  var boxedImageW = boxW\n  var boxedImageH = boxH\n\n  if ((imageW / imageH) > (boxW / boxH)) {\n    boxedImageH = parseInt(imageH * boxW / imageW)\n  }else {\n    boxedImageW = parseInt(imageW * boxH / imageH)\n    if (boxedImageW > boxW) {\n      boxedImageH = parseInt(boxedImageH * boxW / boxedImageW)\n      boxedImageW = boxW\n    }\n  }\n\n  // if (Config.Navigator.retina) {\n  //   imageW = Math.floor(imageW / 2)\n  //   imageH = Math.floor(imageH / 2)\n  // }\n\n  if (noZooom && boxedImageW >= imageW && boxedImageH >= imageH) {\n    boxedImageW = imageW\n    boxedImageH = imageH\n  }\n\n  return {w: boxedImageW, h: boxedImageH}\n}\n\nfunction versionCompare (ver1, ver2) {\n  if (typeof ver1 !== 'string') {\n    ver1 = ''\n  }\n  if (typeof ver2 !== 'string') {\n    ver2 = ''\n  }\n  ver1 = ver1.replace(/^\\s+|\\s+$/g, '').split('.')\n  ver2 = ver2.replace(/^\\s+|\\s+$/g, '').split('.')\n\n  var a = Math.max(ver1.length, ver2.length), i\n\n  for (i = 0; i < a; i++) {\n    if (ver1[i] == ver2[i]) {\n      continue\n    }\n    if (ver1[i] > ver2[i]) {\n      return 1\n    } else {\n      return -1\n    }\n  }\n\n  return 0\n}\n\n(function (global) {\n  var badCharsRe = /[`~!@#$%^&*()\\-_=+\\[\\]\\\\|{}'\";:\\/?.>,<\\s]+/g,\n    trimRe = /^\\s+|\\s$/g\n\n  function createIndex () {\n    return {\n      shortIndexes: {},\n      fullTexts: {}\n    }\n  }\n\n  function cleanSearchText (text) {\n    var hasTag = text.charAt(0) == '%'\n    text = text.replace(badCharsRe, ' ').replace(trimRe, '')\n    text = text.replace(/[^A-Za-z0-9]/g, function (ch) {\n      return Config.LatinizeMap[ch] || ch\n    })\n    text = text.toLowerCase()\n    if (hasTag) {\n      text = '%' + text\n    }\n\n    return text\n  }\n\n  function cleanUsername (username) {\n    return username && username.toLowerCase() || ''\n  }\n\n  function indexObject (id, searchText, searchIndex) {\n    if (searchIndex.fullTexts[id] !== undefined) {\n      return false\n    }\n\n    searchText = cleanSearchText(searchText)\n\n    if (!searchText.length) {\n      return false\n    }\n\n    var shortIndexes = searchIndex.shortIndexes\n\n    searchIndex.fullTexts[id] = searchText\n\n    angular.forEach(searchText.split(' '), function (searchWord) {\n      var len = Math.min(searchWord.length, 3),\n        wordPart, i\n      for (i = 1; i <= len; i++) {\n        wordPart = searchWord.substr(0, i)\n        if (shortIndexes[wordPart] === undefined) {\n          shortIndexes[wordPart] = [id]\n        } else {\n          shortIndexes[wordPart].push(id)\n        }\n      }\n    })\n  }\n\n  function search (query, searchIndex) {\n    var shortIndexes = searchIndex.shortIndexes\n    var fullTexts = searchIndex.fullTexts\n\n    query = cleanSearchText(query)\n\n    var queryWords = query.split(' ')\n    var foundObjs = false,\n      newFoundObjs, i\n    var j, searchText\n    var found\n\n    for (i = 0; i < queryWords.length; i++) {\n      newFoundObjs = shortIndexes[queryWords[i].substr(0, 3)]\n      if (!newFoundObjs) {\n        foundObjs = []\n        break\n      }\n      if (foundObjs === false || foundObjs.length > newFoundObjs.length) {\n        foundObjs = newFoundObjs\n      }\n    }\n\n    newFoundObjs = {}\n\n    for (j = 0; j < foundObjs.length; j++) {\n      found = true\n      searchText = fullTexts[foundObjs[j]]\n      for (i = 0; i < queryWords.length; i++) {\n        if (searchText.indexOf(queryWords[i]) == -1) {\n          found = false\n          break\n        }\n      }\n      if (found) {\n        newFoundObjs[foundObjs[j]] = true\n      }\n    }\n\n    return newFoundObjs\n  }\n\n  global.SearchIndexManager = {\n    createIndex: createIndex,\n    indexObject: indexObject,\n    cleanSearchText: cleanSearchText,\n    cleanUsername: cleanUsername,\n    search: search\n  }\n})(window)\n"]}